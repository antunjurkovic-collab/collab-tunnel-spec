<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Collaboration Tunnel Protocol (TCT)</title>
<meta content="Antun Jurkovikj" name="author">
<meta content="
       This document specifies the Collaboration Tunnel Protocol, an HTTP-based method for efficient, verifiable delivery of web content to automated agents. The protocol uses bidirectional URL discovery, template-invariant content fingerprinting with strong ETags, sitemap-first verification, and strict conditional request discipline to reduce bandwidth while preserving canonical URLs. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-jurkovikj-collab-tunnel-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.3
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
    weasyprint 65.0
-->
<link href="draft-jurkovikj-collab-tunnel-01.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://static.ietf.org/fonts/noto-sans/import.css'); /* Sans-serif */
@import url('https://static.ietf.org/fonts/noto-serif/import.css'); /* Serif (print) */
@import url('https://static.ietf.org/fonts/roboto-mono/import.css'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TCT</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jurkovikj</td>
<td class="center">Expires 18 May 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-jurkovikj-collab-tunnel-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11-14" class="published">14 November 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-05-18">18 May 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Jurkovikj</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Collaboration Tunnel Protocol (TCT)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the Collaboration Tunnel Protocol, an HTTP-based method for efficient, verifiable delivery of web content to automated agents. The protocol uses bidirectional URL discovery, template-invariant content fingerprinting with strong ETags, sitemap-first verification, and strict conditional request discipline to reduce bandwidth while preserving canonical URLs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 May 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="auto internal xref">1.1.1</a>.  <a href="#name-problem-statement" class="internal xref">Problem Statement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="auto internal xref">1.1.2</a>.  <a href="#name-goals-and-non-goals" class="internal xref">Goals and Non-Goals</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-architecture" class="internal xref">Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-design-rationale-and-relati" class="internal xref">Design Rationale and Relation to Existing Mechanisms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-related-work" class="internal xref">Related Work</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="auto internal xref">1.3.2</a>.  <a href="#name-tct-design-choices" class="internal xref">TCT Design Choices</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-discovery" class="internal xref">Discovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-m-sitemap-discovery" class="internal xref">M-Sitemap Discovery</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="auto internal xref">1.4.2</a>.  <a href="#name-m-url-discovery-and-canonic" class="internal xref">M-URL Discovery and Canonical Links</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.3">
                    <p id="section-toc.1-1.1.2.4.2.3.1"><a href="#section-1.4.3" class="auto internal xref">1.4.3</a>.  <a href="#name-template-invariance" class="internal xref">Template-Invariance</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-m-url-representation" class="internal xref">M-URL Representation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.1">
                    <p id="section-toc.1-1.1.2.5.2.1.1"><a href="#section-1.5.1" class="auto internal xref">1.5.1</a>.  <a href="#name-content-type-and-encoding" class="internal xref">Content-Type and Encoding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.2">
                    <p id="section-toc.1-1.1.2.5.2.2.1"><a href="#section-1.5.2" class="auto internal xref">1.5.2</a>.  <a href="#name-required-json-fields" class="internal xref">Required JSON Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.3">
                    <p id="section-toc.1-1.1.2.5.2.3.1"><a href="#section-1.5.3" class="auto internal xref">1.5.3</a>.  <a href="#name-representation-stability" class="internal xref">Representation Stability</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-deterministic-json-and-stro" class="internal xref">Deterministic JSON and Strong ETags</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.1">
                    <p id="section-toc.1-1.1.2.6.2.1.1"><a href="#section-1.6.1" class="auto internal xref">1.6.1</a>.  <a href="#name-deterministic-json-serializ" class="internal xref">Deterministic JSON Serialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.2">
                    <p id="section-toc.1-1.1.2.6.2.2.1"><a href="#section-1.6.2" class="auto internal xref">1.6.2</a>.  <a href="#name-strong-etag-generation-sing" class="internal xref">Strong ETag Generation (Single Method)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.3">
                    <p id="section-toc.1-1.1.2.6.2.3.1"><a href="#section-1.6.3" class="auto internal xref">1.6.3</a>.  <a href="#name-relationship-to-template-in" class="internal xref">Relationship to Template-Invariance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.4">
                    <p id="section-toc.1-1.1.2.6.2.4.1"><a href="#section-1.6.4" class="auto internal xref">1.6.4</a>.  <a href="#name-canonical-text-normalizatio" class="internal xref">Canonical Text Normalization (Optional for Producers)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a href="#section-1.7" class="auto internal xref">1.7</a>.  <a href="#name-m-sitemap-format-and-semant" class="internal xref">M-Sitemap Format and Semantics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7.2.1">
                    <p id="section-toc.1-1.1.2.7.2.1.1"><a href="#section-1.7.1" class="auto internal xref">1.7.1</a>.  <a href="#name-m-sitemap-json-structure" class="internal xref">M-Sitemap JSON Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7.2.2">
                    <p id="section-toc.1-1.1.2.7.2.2.1"><a href="#section-1.7.2" class="auto internal xref">1.7.2</a>.  <a href="#name-http-response-for-m-sitemap" class="internal xref">HTTP Response for M-Sitemap</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7.2.3">
                    <p id="section-toc.1-1.1.2.7.2.3.1"><a href="#section-1.7.3" class="auto internal xref">1.7.3</a>.  <a href="#name-parity-semantics" class="internal xref">Parity Semantics</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8">
                <p id="section-toc.1-1.1.2.8.1"><a href="#section-1.8" class="auto internal xref">1.8</a>.  <a href="#name-client-behavior" class="internal xref">Client Behavior</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8.2.1">
                    <p id="section-toc.1-1.1.2.8.2.1.1"><a href="#section-1.8.1" class="auto internal xref">1.8.1</a>.  <a href="#name-zero-fetch-optimization" class="internal xref">Zero-Fetch Optimization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8.2.2">
                    <p id="section-toc.1-1.1.2.8.2.2.1"><a href="#section-1.8.2" class="auto internal xref">1.8.2</a>.  <a href="#name-conditional-requests-to-m-u" class="internal xref">Conditional Requests to M-URLs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8.2.3">
                    <p id="section-toc.1-1.1.2.8.2.3.1"><a href="#section-1.8.3" class="auto internal xref">1.8.3</a>.  <a href="#name-use-of-head-optional" class="internal xref">Use of HEAD (Optional)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.8.2.4">
                    <p id="section-toc.1-1.1.2.8.2.4.1"><a href="#section-1.8.4" class="auto internal xref">1.8.4</a>.  <a href="#name-client-validation-optional" class="internal xref">Client Validation (Optional)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9">
                <p id="section-toc.1-1.1.2.9.1"><a href="#section-1.9" class="auto internal xref">1.9</a>.  <a href="#name-operational-considerations-" class="internal xref">Operational Considerations (Informative)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9.2.1">
                    <p id="section-toc.1-1.1.2.9.2.1.1"><a href="#section-1.9.1" class="auto internal xref">1.9.1</a>.  <a href="#name-deployment-with-cdns-and-pr" class="internal xref">Deployment with CDNs and Proxies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9.2.2">
                    <p id="section-toc.1-1.1.2.9.2.2.1"><a href="#section-1.9.2" class="auto internal xref">1.9.2</a>.  <a href="#name-large-sites-and-sharding" class="internal xref">Large Sites and Sharding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9.2.3">
                    <p id="section-toc.1-1.1.2.9.2.3.1"><a href="#section-1.9.3" class="auto internal xref">1.9.3</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.9.2.4">
                    <p id="section-toc.1-1.1.2.9.2.4.1"><a href="#section-1.9.4" class="auto internal xref">1.9.4</a>.  <a href="#name-backwards-compatibility" class="internal xref">Backwards Compatibility</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.10">
                <p id="section-toc.1-1.1.2.10.1"><a href="#section-1.10" class="auto internal xref">1.10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.11">
                <p id="section-toc.1-1.1.2.11.1"><a href="#section-1.11" class="auto internal xref">1.11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-appendix-a-normalization-te" class="internal xref">Appendix A. Normalization Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-a1-basic-ascii" class="internal xref">A.1. Basic ASCII</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-a2-html-entities" class="internal xref">A.2. HTML Entities</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-a3-unicode-normalization-nf" class="internal xref">A.3. Unicode Normalization (NFKC)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#appendix-A.1.3" class="auto internal xref">A.1.3</a>.  <a href="#name-a4-case-folding-edge-cases" class="internal xref">A.4. Case Folding Edge Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#appendix-A.1.4" class="auto internal xref">A.1.4</a>.  <a href="#name-a5-control-characters" class="internal xref">A.5. Control Characters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#appendix-A.1.5" class="auto internal xref">A.1.5</a>.  <a href="#name-a6-whitespace-edge-cases" class="internal xref">A.6. Whitespace Edge Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a href="#appendix-A.1.6" class="auto internal xref">A.1.6</a>.  <a href="#name-a7-empty-and-edge-cases" class="internal xref">A.7. Empty and Edge Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.7">
                    <p id="section-toc.1-1.3.2.1.2.7.1"><a href="#appendix-A.1.7" class="auto internal xref">A.1.7</a>.  <a href="#name-a8-complex-real-world-examp" class="internal xref">A.8. Complex Real-World Examples</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.8">
                    <p id="section-toc.1-1.3.2.1.2.8.1"><a href="#appendix-A.1.8" class="auto internal xref">A.1.8</a>.  <a href="#name-a9-implementation-notes" class="internal xref">A.9. Implementation Notes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-appendix-b-example-flows-in" class="internal xref">Appendix B. Example Flows (Informative)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#appendix-A.2.1" class="auto internal xref">A.2.1</a>.  <a href="#name-b1-initial-discovery-and-fi" class="internal xref">B.1. Initial Discovery and First Fetch</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#appendix-A.2.2" class="auto internal xref">A.2.2</a>.  <a href="#name-b2-zero-fetch-optimization-" class="internal xref">B.2. Zero-Fetch Optimization (Content Unchanged)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#appendix-A.2.3" class="auto internal xref">A.2.3</a>.  <a href="#name-b3-conditional-request-cont" class="internal xref">B.3. Conditional Request (Content Unchanged)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#appendix-A.2.4" class="auto internal xref">A.2.4</a>.  <a href="#name-b4-content-changed" class="internal xref">B.4. Content Changed</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#appendix-A.2.5" class="auto internal xref">A.2.5</a>.  <a href="#name-b5-parity-mismatch-handling" class="internal xref">B.5. Parity Mismatch Handling</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#appendix-A.2.6" class="auto internal xref">A.2.6</a>.  <a href="#name-b6-using-head-for-efficient" class="internal xref">B.6. Using HEAD for Efficient Freshness Check</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#appendix-A.2.7" class="auto internal xref">A.2.7</a>.  <a href="#name-b7-discovery-via-c-url" class="internal xref">B.7. Discovery via C-URL</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-appendix-c-implementation-n" class="internal xref">Appendix C. Implementation Notes (Informative)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#appendix-A.3.1" class="auto internal xref">A.3.1</a>.  <a href="#name-c1-reference-implementation" class="internal xref">C.1. Reference Implementations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#appendix-A.3.2" class="auto internal xref">A.3.2</a>.  <a href="#name-c2-deterministic-json-libra" class="internal xref">C.2. Deterministic JSON Libraries</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#appendix-A.3.3" class="auto internal xref">A.3.3</a>.  <a href="#name-c3-sha-256-computation" class="internal xref">C.3. SHA-256 Computation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-canonical-json" class="internal xref">Canonical JSON</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-hash" class="internal xref">Hash</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-c4-unicode-normalization" class="internal xref">C.4. Unicode Normalization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-nfkc-normalization" class="internal xref">NFKC normalization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-case-folding" class="internal xref">Case folding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-E.1" class="auto internal xref">E.1</a>.  <a href="#name-c5-http-response-headers" class="internal xref">C.5. HTTP Response Headers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-response-if-unchanged" class="internal xref">Response if unchanged</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-G" class="auto internal xref">Appendix G</a>.  <a href="#name-response-if-changed" class="internal xref">Response if changed</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-G.1" class="auto internal xref">G.1</a>.  <a href="#name-c6-production-deployment-da" class="internal xref">C.6. Production Deployment Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#appendix-G.1.1" class="auto internal xref">G.1.1</a>.  <a href="#name-c7-common-implementation-pi" class="internal xref">C.7. Common Implementation Pitfalls</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#appendix-G.1.2" class="auto internal xref">G.1.2</a>.  <a href="#name-c8-testing-and-validation" class="internal xref">C.8. Testing and Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#appendix-G.1.3" class="auto internal xref">G.1.3</a>.  <a href="#name-c9-performance-consideratio" class="internal xref">C.9. Performance Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#appendix-G.1.4" class="auto internal xref">G.1.4</a>.  <a href="#name-c10-security-best-practices" class="internal xref">C.10. Security Best Practices</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-H" class="auto internal xref">Appendix H</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-I" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Automated agents (search engines, AI crawlers, archives, monitoring tools, aggregators) increasingly consume web content at scale. Fetching and parsing full HTML pages for machine consumption is often inefficient:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">
          <p id="section-1-2.1.1">Page weight is dominated by templates, navigation, ads, and scripts.<a href="#section-1-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.2">
          <p id="section-1-2.2.1">Machine consumers typically need a stable textual representation of the core content.<a href="#section-1-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.3">
          <p id="section-1-2.3.1">Many pages do not change frequently, but are re-fetched in full.<a href="#section-1-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-3">Various sites already expose JSON APIs or feeds, but:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">formats differ across sites, and<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">use of HTTP validators is inconsistent.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">The Collaboration Tunnel Protocol (TCT) defines a simple, interoperable profile on top of HTTP that:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1">exposes a canonical JSON representation (M-URL) for selected resources;<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1">advertises C-URL/M-URL mappings and validators in a JSON sitemap (M-Sitemap);<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.3">
          <p id="section-1-6.3.1">uses a single, well-defined strong ETag method for M-URLs; and<a href="#section-1-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.4">
          <p id="section-1-6.4.1">enables "zero-fetch" behavior when content is unchanged.<a href="#section-1-6.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-7">TCT is intentionally conservative: it uses only existing HTTP mechanisms, is backward compatible with the Web, and does not define policy or licensing semantics.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">C-URL:<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1.2.1">
                <p id="section-1.1-2.1.2.1.1">The canonical, human-facing URL of a resource, typically an HTML document.<a href="#section-1.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">M-URL:<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.2.2.1">
                <p id="section-1.1-2.2.2.1.1">The machine-facing URL providing the TCT JSON representation of that resource.<a href="#section-1.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">M-Sitemap:<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.3.2.1">
                <p id="section-1.1-2.3.2.1.1">The JSON sitemap enumerating C-URL/M-URL pairs and associated validators.<a href="#section-1.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">Representation:<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.4.2.1">
                <p id="section-1.1-2.4.2.1.1">As defined in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>: the information in a payload, including representation metadata, that is subject to content negotiation.<a href="#section-1.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.1-3">Unless stated otherwise, "client" refers to an automated agent that is aware of TCT.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<div id="problem-statement">
<section id="section-1.1.1">
          <h4 id="name-problem-statement">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
          </h4>
<p id="section-1.1.1-1">Key inefficiencies in current automated consumption of web content include:<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.1-2.1">
              <p id="section-1.1.1-2.1.1">repeated transfer of large HTML documents whose core content has not changed;<a href="#section-1.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.1-2.2">
              <p id="section-1.1.1-2.2.1">lack of a standard, compact, semantics-focused representation for page-like resources;<a href="#section-1.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.1-2.3">
              <p id="section-1.1.1-2.3.1">ad hoc usage or absence of validators (ETag, Last-Modified), hindering efficient revalidation;<a href="#section-1.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.1-2.4">
              <p id="section-1.1.1-2.4.1">difficulty for agents to reason about change detection at scale using only HTML and XML sitemaps.<a href="#section-1.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="goals-and-non-goals">
<section id="section-1.1.2">
          <h4 id="name-goals-and-non-goals">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-goals-and-non-goals" class="section-name selfRef">Goals and Non-Goals</a>
          </h4>
<p id="section-1.1.2-1">TCT is designed to:<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-2.1">
              <p id="section-1.1.2-2.1.1">reuse HTTP semantics (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>, <span>[<a href="#RFC9111" class="cite xref">RFC9111</a>]</span>) rather than introduce new ones;<a href="#section-1.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.2-2.2">
              <p id="section-1.1.2-2.2.1">provide a simple, deterministic JSON representation appropriate for:<a href="#section-1.1.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-2.2.2.1">
                  <p id="section-1.1.2-2.2.2.1.1">search indexing,<a href="#section-1.1.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.1.2-2.2.2.2">
                  <p id="section-1.1.2-2.2.2.2.1">content analysis,<a href="#section-1.1.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.1.2-2.2.2.3">
                  <p id="section-1.1.2-2.2.2.3.1">retrieval-augmented generation (RAG),<a href="#section-1.1.2-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.1.2-2.2.2.4">
                  <p id="section-1.1.2-2.2.2.4.1">archival and monitoring;<a href="#section-1.1.2-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.1.2-2.3">
              <p id="section-1.1.2-2.3.1">define discovery and validation clearly enough for interoperable clients and servers.<a href="#section-1.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.1.2-3">TCT explicitly does NOT:<a href="#section-1.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1.2-4.1">
              <p id="section-1.1.2-4.1.1">define how content may or may not be used (policy, licensing, AI usage);<a href="#section-1.1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.2-4.2">
              <p id="section-1.1.2-4.2.1">change the semantics of resources at C-URLs;<a href="#section-1.1.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.1.2-4.3">
              <p id="section-1.1.2-4.3.1">require new HTTP methods or status codes.<a href="#section-1.1.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="architecture">
<section id="section-1.2">
        <h3 id="name-architecture">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
        </h3>
<p id="section-1.2-1">TCT introduces three main elements per participating origin:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">C-URL:<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1.2.1">
                <p id="section-1.2-2.1.2.1.1">The canonical resource URL for humans, often serving HTML.<a href="#section-1.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">M-URL:<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.2.2.1">
                <p id="section-1.2-2.2.2.1.1">A URL providing a canonical JSON representation of the same logical resource (TCT JSON).<a href="#section-1.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.2-2.3">
            <p id="section-1.2-2.3.1">M-Sitemap:<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.3.2.1">
                <p id="section-1.2-2.3.2.1.1">A JSON document listing C-URLs, M-URLs, and strong validators (<code>etag</code> values).<a href="#section-1.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-1.2-3">High-level flow (informative):<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-4">
<li id="section-1.2-4.1">
            <p id="section-1.2-4.1.1">Client performs <code>GET /</code> at <code>https://example.com/</code>.<a href="#section-1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">The origin root response includes:<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.2.2.1">
                <p id="section-1.2-4.2.2.1.1"><code>Link: &lt;/llm-pages.json&gt;; rel="index"; type="application/json"</code>.<a href="#section-1.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-1.2-4.3">
            <p id="section-1.2-4.3.1">Client fetches <code>/llm-pages.json</code> (M-Sitemap).<a href="#section-1.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-1.2-4.4">
            <p id="section-1.2-4.4.1">For each item:<a href="#section-1.2-4.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.4.2.1">
                <p id="section-1.2-4.4.2.1.1">learns <code>(cUrl, mUrl, etag)</code>.<a href="#section-1.2-4.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-1.2-4.5">
            <p id="section-1.2-4.5.1">Client fetches <code>mUrl</code> as needed:<a href="#section-1.2-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.5.2.1">
                <p id="section-1.2-4.5.2.1.1"><code>GET mUrl</code>, with <code>If-None-Match</code> on subsequent checks.<a href="#section-1.2-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-1.2-4.6">
            <p id="section-1.2-4.6.1">Server responds with:<a href="#section-1.2-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-4.6.2.1">
                <p id="section-1.2-4.6.2.1.1"><code>200 OK</code> + JSON when changed;<a href="#section-1.2-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.2-4.6.2.2">
                <p id="section-1.2-4.6.2.2.1"><code>304 Not Modified</code> when unchanged.<a href="#section-1.2-4.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-1.2-5">TCT is additive and optional:<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-6.1">
            <p id="section-1.2-6.1.1">Non-TCT clients ignore TCT artifacts.<a href="#section-1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-6.2">
            <p id="section-1.2-6.2.1">Servers can deploy TCT gradually alongside existing content and sitemaps.<a href="#section-1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="design-rationale-and-relation-to-existing-mechanisms">
<section id="section-1.3">
        <h3 id="name-design-rationale-and-relati">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-design-rationale-and-relati" class="section-name selfRef">Design Rationale and Relation to Existing Mechanisms</a>
        </h3>
<p id="section-1.3-1">TCT is grounded in existing mechanisms and complements several related efforts:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<div id="related-work">
<section id="section-1.3.1">
          <h4 id="name-related-work">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-related-work" class="section-name selfRef">Related Work</a>
          </h4>
<p id="section-1.3.1-1"><strong>XML Sitemaps:</strong>
- Widely deployed for URL discovery (search engines, crawlers).
- Provide <code>&lt;lastmod&gt;</code> timestamps but do not define normative bindings between sitemap entries and HTTP validators (ETags) for endpoint representations.
- TCT builds on this model by adding structured JSON representations and strong validator integration.<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-1.3.1-2"><strong>ResourceSync:</strong>
- Developed by the Open Archives Initiative and collaborators for resource synchronization in digital libraries.
- Provides resource lists, change lists, and capability documents.
- Focus is synchronization and preservation; does not define a single, tightly integrated pattern combining:
  - per-resource JSON representation,
  - sitemap listing with validators, and
  - ETag-based zero-fetch semantics.
- TCT addresses the specific use case of efficient web content delivery to automated agents.<a href="#section-1.3.1-2" class="pilcrow">¶</a></p>
<p id="section-1.3.1-3"><strong>AMP (Accelerated Mobile Pages):</strong>
- Defines an HTML subset optimized for fast rendering on mobile devices.
- Provides alternate representations via <code>&lt;link rel="amphtml"&gt;</code>.
- TCT provides JSON (not HTML) for machine consumption, targeting crawlers and content analysis rather than human browsing.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<p id="section-1.3.1-4"><strong>Custom JSON APIs:</strong>
- Many sites expose custom JSON endpoints for content access.
- Structures, field names, and validator usage vary widely across implementations.
- TCT aims to standardize a minimal, interoperable profile suitable for broad adoption.<a href="#section-1.3.1-4" class="pilcrow">¶</a></p>
<p id="section-1.3.1-5"><strong>robots.txt:</strong>
- Defines crawl directives and access policies.
- TCT does not replace robots.txt; publishers MAY use both mechanisms:
  - robots.txt for crawl permissions and rate guidance, and
  - TCT for efficient content delivery.<a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
<p id="section-1.3.1-6"><strong>RSS/Atom Feeds:</strong>
- Provide syndication of updates and content excerpts.
- Typically lack HTTP caching integration (per-item ETags, conditional requests).
- TCT can be viewed as "RSS with disciplined HTTP caching semantics."<a href="#section-1.3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tct-design-choices">
<section id="section-1.3.2">
          <h4 id="name-tct-design-choices">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-tct-design-choices" class="section-name selfRef">TCT Design Choices</a>
          </h4>
<p id="section-1.3.2-1">Key design choices in TCT:<a href="#section-1.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-2.1">
              <p id="section-1.3.2-2.1.1">Use only existing HTTP semantics:<a href="#section-1.3.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-2.1.2.1">
                  <p id="section-1.3.2-2.1.2.1.1">GET, HEAD, 200, 304, ETag, Cache-Control, Link.<a href="#section-1.3.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.3.2-2.2">
              <p id="section-1.3.2-2.2.1">Use JSON as the machine representation:<a href="#section-1.3.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-2.2.2.1">
                  <p id="section-1.3.2-2.2.2.1.1">Simple, widely supported, easy to parse.<a href="#section-1.3.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.3.2-2.2.2.2">
                  <p id="section-1.3.2-2.2.2.2.1">TCT is complementary to existing HTTP content-coding and dictionary-based compression mechanisms: it reduces representation size and refetch frequency at the application layer while remaining fully compatible with compression applied to M-URL responses.<a href="#section-1.3.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.3.2-2.3">
              <p id="section-1.3.2-2.3.1">Define one strong ETag method:<a href="#section-1.3.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-2.3.2.1">
                  <p id="section-1.3.2-2.3.2.1.1">Based on canonical JSON bytes of the M-URL payload.<a href="#section-1.3.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.3.2-2.3.2.2">
                  <p id="section-1.3.2-2.3.2.2.1">Avoid ambiguous or dual hash methods.<a href="#section-1.3.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.3.2-2.4">
              <p id="section-1.3.2-2.4.1">Keep policy and energy considerations out of the core:<a href="#section-1.3.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-2.4.2.1">
                  <p id="section-1.3.2-2.4.2.1.1">Those can be specified separately as informational work.<a href="#section-1.3.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.3.2-3">The intent is to offer an interoperable profile that is:<a href="#section-1.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.2-4.1">
              <p id="section-1.3.2-4.1.1">easy to implement,<a href="#section-1.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.2-4.2">
              <p id="section-1.3.2-4.2.1">friendly to existing caches/CDNs, and<a href="#section-1.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.2-4.3">
              <p id="section-1.3.2-4.3.1">precise enough for standardization.<a href="#section-1.3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="discovery">
<section id="section-1.4">
        <h3 id="name-discovery">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
        </h3>
<div id="m-sitemap-discovery">
<section id="section-1.4.1">
          <h4 id="name-m-sitemap-discovery">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-m-sitemap-discovery" class="section-name selfRef">M-Sitemap Discovery</a>
          </h4>
<p id="section-1.4.1-1">A publisher implementing TCT MUST expose an M-Sitemap and advertise it from the origin root resource.<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-1.4.1-2">When a client performs:<a href="#section-1.4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-3.1">
              <p id="section-1.4.1-3.1.1"><code>GET /</code> with <code>Host: example.com</code><a href="#section-1.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-4">and receives a successful (2xx) response (either directly or after following redirects per <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>), that response:<a href="#section-1.4.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-5.1">
              <p id="section-1.4.1-5.1.1">MUST include a <code>Link</code> header with:<a href="#section-1.4.1-5.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-5.1.2.1">
                  <p id="section-1.4.1-5.1.2.1.1"><code>rel="index"</code><a href="#section-1.4.1-5.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.4.1-5.1.2.2">
                  <p id="section-1.4.1-5.1.2.2.1"><code>type="application/json"</code><a href="#section-1.4.1-5.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.4.1-5.1.2.3">
                  <p id="section-1.4.1-5.1.2.3.1">a target that is the M-Sitemap URL for this origin.<a href="#section-1.4.1-5.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.4.1-6">Example:<a href="#section-1.4.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-7.1">
              <p id="section-1.4.1-7.1.1"><code>Link: &lt;/llm-sitemap.json&gt;; rel="index"; type="application/json"</code><a href="#section-1.4.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-8">In this specification, a Link header field with <code>rel="index"</code>, <code>type="application/json"</code>, and a target whose content matches Section 7 identifies the TCT M-Sitemap for that origin. Other uses of <code>rel="index"</code> remain valid and are outside the scope of this document.<a href="#section-1.4.1-8" class="pilcrow">¶</a></p>
<p id="section-1.4.1-9">Notes:<a href="#section-1.4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-10.1">
              <p id="section-1.4.1-10.1.1"><code>/llm-sitemap.json</code> is an example; any stable path MAY be used.<a href="#section-1.4.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-10.2">
              <p id="section-1.4.1-10.2.1">If <code>/</code> redirects (e.g., <code>301</code> or <code>302</code> to <code>/en/</code> or <code>/index.html</code>), the <code>Link</code> header MUST appear on the final redirect target.<a href="#section-1.4.1-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.1-10.3">
              <p id="section-1.4.1-10.3.1">Clients:<a href="#section-1.4.1-10.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.1-10.3.2.1">
                  <p id="section-1.4.1-10.3.2.1.1">SHOULD follow redirects per <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> before checking for TCT support.<a href="#section-1.4.1-10.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.4.1-10.3.2.2">
                  <p id="section-1.4.1-10.3.2.2.1">MUST discover the M-Sitemap via the <code>Link</code> header on the final response.<a href="#section-1.4.1-10.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.4.1-10.3.2.3">
                  <p id="section-1.4.1-10.3.2.3.1">If no such <code>Link</code> is present, SHOULD assume TCT is not deployed and MUST NOT guess paths.<a href="#section-1.4.1-10.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.4.1-10.4">
              <p id="section-1.4.1-10.4.1">If multiple <code>Link</code> headers with <code>rel="index"</code> and <code>type="application/json"</code> are present, clients MAY choose any or load all. This document does not define multi-sitemap selection semantics; large-site sharding is left to operational conventions (see Section 9.2).<a href="#section-1.4.1-10.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.1-11">This specification does not define or require any <code>/.well-known/</code> URI.<a href="#section-1.4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="m-url-discovery-and-canonical-links">
<section id="section-1.4.2">
          <h4 id="name-m-url-discovery-and-canonic">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-m-url-discovery-and-canonic" class="section-name selfRef">M-URL Discovery and Canonical Links</a>
          </h4>
<p id="section-1.4.2-1">For each resource where an M-URL is provided:<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1">
              <p id="section-1.4.2-2.1.1">The C-URL response (typically HTML) SHOULD advertise the M-URL as an alternate JSON representation:<a href="#section-1.4.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-1.4.2-2.1.2">
Either via HTML:<a href="#section-1.4.2-2.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1.3.1">
                  <p id="section-1.4.2-2.1.3.1.1"><code>&lt;link rel="alternate" type="application/json" href="https://example.com/post/llm.json"&gt;</code><a href="#section-1.4.2-2.1.3.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-1.4.2-2.1.4">
Or HTTP:<a href="#section-1.4.2-2.1.4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1.5.1">
                  <p id="section-1.4.2-2.1.5.1.1"><code>Link: &lt;https://example.com/post/llm.json&gt;; rel="alternate"; type="application/json"</code><a href="#section-1.4.2-2.1.5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.4.2-2.2">
              <p id="section-1.4.2-2.2.1">The M-URL response for that resource MUST include a corresponding canonical link (<span>[<a href="#RFC6596" class="cite xref">RFC6596</a>]</span>):<a href="#section-1.4.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.2.2.1">
                  <p id="section-1.4.2-2.2.2.1.1"><code>Link: &lt;https://example.com/post/&gt;; rel="canonical"</code><a href="#section-1.4.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.4.2-3"><strong>Note on M-URL paths:</strong>
The choice of M-URL path (e.g., <code>/post/llm.json</code>, <code>/post/llm/</code>, <code>/post.json</code>, etc.) is not specified by this document. Publishers MAY choose any stable URL scheme that suits their architecture. Clients MUST discover M-URLs via advertised links (as shown above) and MUST NOT assume a fixed path pattern.<a href="#section-1.4.2-3" class="pilcrow">¶</a></p>
<p id="section-1.4.2-4">Examples of valid M-URL patterns:
- <code>https://example.com/post/llm.json</code> (used in this document)
- <code>https://example.com/post/llm/</code> (directory-style)
- <code>https://example.com/post.json</code> (extension-based)<a href="#section-1.4.2-4" class="pilcrow">¶</a></p>
<p id="section-1.4.2-5">This bidirectional linkage allows clients to:<a href="#section-1.4.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-6.1">
              <p id="section-1.4.2-6.1.1">verify that an M-URL is an alternate for the expected C-URL;<a href="#section-1.4.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.2-6.2">
              <p id="section-1.4.2-6.2.1">detect misconfigurations when links are inconsistent; and<a href="#section-1.4.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.2-6.3">
              <p id="section-1.4.2-6.3.1">ensure the <code>canonical_url</code> field in the M-URL JSON matches (or is consistent with) the URL advertised via <code>rel="canonical"</code> for the corresponding C-URL.<a href="#section-1.4.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="template-invariance">
<section id="section-1.4.3">
          <h4 id="name-template-invariance">
<a href="#section-1.4.3" class="section-number selfRef">1.4.3. </a><a href="#name-template-invariance" class="section-name selfRef">Template-Invariance</a>
          </h4>
<p id="section-1.4.3-1">TCT's template-invariance property:<a href="#section-1.4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.3-2.1">
              <p id="section-1.4.3-2.1.1">Changes to HTML templates, CSS, or JavaScript at the C-URL SHOULD NOT require changes to the M-URL JSON, so long as the underlying resource content has not changed.<a href="#section-1.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.3-3">This is achieved by:<a href="#section-1.4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.3-4.1">
              <p id="section-1.4.3-4.1.1">treating M-URLs as distinct, canonical JSON representations of content; and<a href="#section-1.4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.3-4.2">
              <p id="section-1.4.3-4.2.1">computing strong ETags over the M-URL JSON only.<a href="#section-1.4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.4.3-5">Template-invariance is NOT achieved by relaxing strong ETag semantics; for any given M-URL, identical strong ETags MUST imply byte-identical JSON bodies.<a href="#section-1.4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="m-url-representation">
<section id="section-1.5">
        <h3 id="name-m-url-representation">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-m-url-representation" class="section-name selfRef">M-URL Representation</a>
        </h3>
<p id="section-1.5-1">An M-URL is an HTTP resource that serves a JSON representation of a content resource suitable for machine consumption.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<p id="section-1.5-2">This specification defines the observable JSON representation at M-URLs; it does not constrain how servers derive these representations from their internal data models, templates, or storage.<a href="#section-1.5-2" class="pilcrow">¶</a></p>
<div id="content-type-and-encoding">
<section id="section-1.5.1">
          <h4 id="name-content-type-and-encoding">
<a href="#section-1.5.1" class="section-number selfRef">1.5.1. </a><a href="#name-content-type-and-encoding" class="section-name selfRef">Content-Type and Encoding</a>
          </h4>
<p id="section-1.5.1-1">M-URL responses:<a href="#section-1.5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.1-2.1">
              <p id="section-1.5.1-2.1.1">MUST use:<a href="#section-1.5.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.1-2.1.2.1">
                  <p id="section-1.5.1-2.1.2.1.1"><code>Content-Type: application/json; charset=utf-8</code><a href="#section-1.5.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.5.1-2.2">
              <p id="section-1.5.1-2.2.1">MUST be valid JSON as per <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>.<a href="#section-1.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.5.1-2.3">
              <p id="section-1.5.1-2.3.1">MUST use UTF-8 without BOM.<a href="#section-1.5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="required-json-fields">
<section id="section-1.5.2">
          <h4 id="name-required-json-fields">
<a href="#section-1.5.2" class="section-number selfRef">1.5.2. </a><a href="#name-required-json-fields" class="section-name selfRef">Required JSON Fields</a>
          </h4>
<p id="section-1.5.2-1">The minimal M-URL JSON object for a resource MUST contain:<a href="#section-1.5.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.1">
              <p id="section-1.5.2-2.1.1"><code>canonical_url</code> (string, REQUIRED)<a href="#section-1.5.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.1.2.1">
                  <p id="section-1.5.2-2.1.2.1.1">The canonical human-facing URL (C-URL).<a href="#section-1.5.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.5.2-2.2">
              <p id="section-1.5.2-2.2.1"><code>title</code> (string, REQUIRED)<a href="#section-1.5.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.2.2.1">
                  <p id="section-1.5.2-2.2.2.1.1">A human-readable title for the resource.<a href="#section-1.5.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.5.2-2.3">
              <p id="section-1.5.2-2.3.1"><code>content</code> (string, REQUIRED)<a href="#section-1.5.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.3.2.1">
                  <p id="section-1.5.2-2.3.2.1.1">Core textual content:<a href="#section-1.5.2-2.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.3.2.1.2.1">
                      <p id="section-1.5.2-2.3.2.1.2.1.1">plain text (no raw HTML markup);<a href="#section-1.5.2-2.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-1.5.2-2.3.2.1.2.2">
                      <p id="section-1.5.2-2.3.2.1.2.2.1">SHOULD exclude purely template/boilerplate text.<a href="#section-1.5.2-2.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.5.2-2.4">
              <p id="section-1.5.2-2.4.1"><code>hash</code> (string, REQUIRED)<a href="#section-1.5.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.4.2.1">
                  <p id="section-1.5.2-2.4.2.1.1">A validator string of the form:<a href="#section-1.5.2-2.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-2.4.2.1.2.1">
                      <p id="section-1.5.2-2.4.2.1.2.1.1"><code>sha256-</code> followed by 64 lowercase hex characters,<a href="#section-1.5.2-2.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-1.5.2-2.4.2.1.2.2">
                      <p id="section-1.5.2-2.4.2.1.2.2.1">computed as specified in Section 6.2.<a href="#section-1.5.2-2.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-1.5.2-2.4.2.2">
                  <p id="section-1.5.2-2.4.2.2.1">The <code>hash</code> field of an M-URL representation MUST equal the strong <code>ETag</code> value for that representation, excluding the HTTP quoting.<a href="#section-1.5.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.5.2-3">Additionally:<a href="#section-1.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-4.1">
              <p id="section-1.5.2-4.1.1"><code>profile</code> (string, RECOMMENDED)<a href="#section-1.5.2-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.2-4.1.2.1">
                  <p id="section-1.5.2-4.1.2.1.1">TCT profile identifier, e.g., <code>tct-1</code>.<a href="#section-1.5.2-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.5.2-5">Example (non-normative):<a href="#section-1.5.2-5" class="pilcrow">¶</a></p>
<p id="section-1.5.2-6"><code>json
{
  "profile": "tct-1",
  "canonical_url": "https://example.com/post/",
  "title": "Article Title",
  "content": "Core article content...",
  "hash": "sha256-2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7"
}
</code><a href="#section-1.5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="representation-stability">
<section id="section-1.5.3">
          <h4 id="name-representation-stability">
<a href="#section-1.5.3" class="section-number selfRef">1.5.3. </a><a href="#name-representation-stability" class="section-name selfRef">Representation Stability</a>
          </h4>
<p id="section-1.5.3-1">For an M-URL implementing this specification:<a href="#section-1.5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5.3-2.1">
              <p id="section-1.5.3-2.1.1">For a given resource state, the JSON body MUST be deterministic.<a href="#section-1.5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.5.3-2.2">
              <p id="section-1.5.3-2.2.1">Any change to the JSON body bytes (including required or optional fields) MUST result in a different strong ETag (Section 6.2).<a href="#section-1.5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.5.3-2.3">
              <p id="section-1.5.3-2.3.1">Servers MUST NOT include per-request randomness (e.g., varying timestamps) in the TCT JSON representation.<a href="#section-1.5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="deterministic-json-and-strong-etags">
<section id="section-1.6">
        <h3 id="name-deterministic-json-and-stro">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-deterministic-json-and-stro" class="section-name selfRef">Deterministic JSON and Strong ETags</a>
        </h3>
<div id="deterministic-json-serialization">
<section id="section-1.6.1">
          <h4 id="name-deterministic-json-serializ">
<a href="#section-1.6.1" class="section-number selfRef">1.6.1. </a><a href="#name-deterministic-json-serializ" class="section-name selfRef">Deterministic JSON Serialization</a>
          </h4>
<p id="section-1.6.1-1">M-URL responses MUST use deterministic JSON serialization sufficient to support strong ETag semantics:<a href="#section-1.6.1-1" class="pilcrow">¶</a></p>
<p id="section-1.6.1-2">Implementations SHOULD use the JSON Canonicalization Scheme (JCS) defined in <span>[<a href="#RFC8785" class="cite xref">RFC8785</a>]</span>. Implementations that do not use RFC8785 MUST define and implement a canonicalization algorithm that:<a href="#section-1.6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.1-3.1">
              <p id="section-1.6.1-3.1.1">produces a single, unique octet sequence for each abstract JSON value;<a href="#section-1.6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.1-3.2">
              <p id="section-1.6.1-3.2.1">applies stable ordering of object members at all levels (for example, lexicographic by code point);<a href="#section-1.6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.1-3.3">
              <p id="section-1.6.1-3.3.1">uses deterministic formatting of numbers; and<a href="#section-1.6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.1-3.4">
              <p id="section-1.6.1-3.4.1">does not introduce insignificant whitespace beyond what is necessary to delimit JSON tokens.<a href="#section-1.6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.6.1-4">The same canonicalization algorithm MUST be used both when computing the ETag and when generating the response body.<a href="#section-1.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="strong-etag-generation-single-method">
<section id="section-1.6.2">
          <h4 id="name-strong-etag-generation-sing">
<a href="#section-1.6.2" class="section-number selfRef">1.6.2. </a><a href="#name-strong-etag-generation-sing" class="section-name selfRef">Strong ETag Generation (Single Method)</a>
          </h4>
<p id="section-1.6.2-1">TCT defines one mandatory method for computing ETags for M-URLs.<a href="#section-1.6.2-1" class="pilcrow">¶</a></p>
<p id="section-1.6.2-2">For an M-URL representation:<a href="#section-1.6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.6.2-3">
<li id="section-1.6.2-3.1">
              <p id="section-1.6.2-3.1.1">Construct the full JSON object representing the resource, including all fields except <code>hash</code>.<a href="#section-1.6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.6.2-3.2">
              <p id="section-1.6.2-3.2.1">Canonicalize this JSON object to a UTF-8 byte sequence as per Section 6.1.<a href="#section-1.6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.6.2-3.3">
              <p id="section-1.6.2-3.3.1">Compute the SHA-256 digest of these bytes.<a href="#section-1.6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.6.2-3.4">
              <p id="section-1.6.2-3.4.1">Let $F$ be the 64-character lowercase hex encoding of this digest.<a href="#section-1.6.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.6.2-3.5">
              <p id="section-1.6.2-3.5.1">Set:<a href="#section-1.6.2-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-3.5.2.1">
                  <p id="section-1.6.2-3.5.2.1.1">HTTP <code>ETag</code> header:<a href="#section-1.6.2-3.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-3.5.2.1.2.1">
                      <p id="section-1.6.2-3.5.2.1.2.1.1"><code>"sha256-</code>$F<code>"</code><a href="#section-1.6.2-3.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-1.6.2-3.5.2.2">
                  <p id="section-1.6.2-3.5.2.2.1">JSON <code>hash</code> field:<a href="#section-1.6.2-3.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-3.5.2.2.2.1">
                      <p id="section-1.6.2-3.5.2.2.2.1.1"><code>sha256-</code>$F$<a href="#section-1.6.2-3.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-1.6.2-3.6">
              <p id="section-1.6.2-3.6.1">Canonicalize the final JSON object (now including <code>hash</code>) using the same algorithm defined in Section 6.1, and send that canonical form as the response body.<a href="#section-1.6.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-1.6.2-4">Implementations MUST NOT compute the ETag over one serialization of the JSON object and send a different, non-canonical serialization on the wire.<a href="#section-1.6.2-4" class="pilcrow">¶</a></p>
<p id="section-1.6.2-5">Requirements:<a href="#section-1.6.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-6.1">
              <p id="section-1.6.2-6.1.1">ETags for M-URLs:<a href="#section-1.6.2-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.2-6.1.2.1">
                  <p id="section-1.6.2-6.1.2.1.1">MUST be strong (no <code>W/</code> prefix).<a href="#section-1.6.2-6.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.6.2-6.1.2.2">
                  <p id="section-1.6.2-6.1.2.2.1">MUST be quoted-strings as in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.6.2-6.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.6.2-6.2">
              <p id="section-1.6.2-6.2.1">Two successful M-URL responses with the same strong ETag MUST have identical response body bytes.<a href="#section-1.6.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.2-6.3">
              <p id="section-1.6.2-6.3.1">Any change in the response body bytes MUST cause the strong ETag to change.<a href="#section-1.6.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="relationship-to-template-invariance">
<section id="section-1.6.3">
          <h4 id="name-relationship-to-template-in">
<a href="#section-1.6.3" class="section-number selfRef">1.6.3. </a><a href="#name-relationship-to-template-in" class="section-name selfRef">Relationship to Template-Invariance</a>
          </h4>
<p id="section-1.6.3-1">Strong ETags in TCT are validators for the M-URL JSON representation only.<a href="#section-1.6.3-1" class="pilcrow">¶</a></p>
<p id="section-1.6.3-2">Template-invariance is achieved structurally:<a href="#section-1.6.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.3-3.1">
              <p id="section-1.6.3-3.1.1">M-URLs do not include HTML templates or layout.<a href="#section-1.6.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.3-3.2">
              <p id="section-1.6.3-3.2.1">Changes to C-URL HTML that do not affect the M-URL JSON do not affect the strong ETag.<a href="#section-1.6.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.3-3.3">
              <p id="section-1.6.3-3.3.1">For TCT-conformant M-URLs, strong ETags MUST be representation-based and MUST NOT vary per request in the absence of a change to the underlying JSON representation.<a href="#section-1.6.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="canonical-text-normalization-optional-for-producers">
<section id="section-1.6.4">
          <h4 id="name-canonical-text-normalizatio">
<a href="#section-1.6.4" class="section-number selfRef">1.6.4. </a><a href="#name-canonical-text-normalizatio" class="section-name selfRef">Canonical Text Normalization (Optional for Producers)</a>
          </h4>
<p id="section-1.6.4-1">TCT does not require clients to normalize text or recompute hashes.<a href="#section-1.6.4-1" class="pilcrow">¶</a></p>
<p id="section-1.6.4-2">Use of this normalization algorithm is OPTIONAL and is not required for TCT conformance by either servers or clients. It defines an additional 'TCT text normalization' profile for implementations that choose to adopt it.<a href="#section-1.6.4-2" class="pilcrow">¶</a></p>
<p id="section-1.6.4-3">However, producers or validators that derive text fields (such as <code>content</code>) from upstream formats MAY implement the normalization algorithm defined here to ensure stable input before JSON canonicalization.<a href="#section-1.6.4-3" class="pilcrow">¶</a></p>
<p id="section-1.6.4-4">If an implementation claims conformance to this normalization, it:<a href="#section-1.6.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-5.1">
              <p id="section-1.6.4-5.1.1">MUST follow the algorithm in this section; and<a href="#section-1.6.4-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.6.4-5.2">
              <p id="section-1.6.4-5.2.1">MUST pass the test vectors in Appendix A.<a href="#section-1.6.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.6.4-6">Algorithm (summary):<a href="#section-1.6.4-6" class="pilcrow">¶</a></p>
<p id="section-1.6.4-7">Given input string S:<a href="#section-1.6.4-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.6.4-8">
<li id="section-1.6.4-8.1">
              <p id="section-1.6.4-8.1.1">(Optional) HTML entity decoding:<a href="#section-1.6.4-8.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.1.2.1">
                  <p id="section-1.6.4-8.1.2.1.1">If starting from HTML source, deterministically decode character references.<a href="#section-1.6.4-8.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-1.6.4-8.2">
              <p id="section-1.6.4-8.2.1">Unicode normalization:<a href="#section-1.6.4-8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.2.2.1">
                  <p id="section-1.6.4-8.2.2.1.1">Apply NFKC as defined in Unicode Standard Annex #15 (UAX15).<a href="#section-1.6.4-8.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-1.6.4-8.3">
              <p id="section-1.6.4-8.3.1">Case folding:<a href="#section-1.6.4-8.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.3.2.1">
                  <p id="section-1.6.4-8.3.2.1.1">Apply Unicode case folding as defined in Unicode-CaseFolding.<a href="#section-1.6.4-8.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.6.4-8.3.2.2">
                  <p id="section-1.6.4-8.3.2.2.1">Locale-dependent mappings MUST NOT be used.<a href="#section-1.6.4-8.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-1.6.4-8.4">
              <p id="section-1.6.4-8.4.1">Control characters:<a href="#section-1.6.4-8.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.4.2.1">
                  <p id="section-1.6.4-8.4.2.1.1">Remove all Cc characters except:<a href="#section-1.6.4-8.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.4.2.1.2.1">
                      <p id="section-1.6.4-8.4.2.1.2.1.1">U+0009 (TAB), U+000A (LF), U+000D (CR).<a href="#section-1.6.4-8.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-1.6.4-8.5">
              <p id="section-1.6.4-8.5.1">Whitespace collapsing:<a href="#section-1.6.4-8.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.5.2.1">
                  <p id="section-1.6.4-8.5.2.1.1">Define set W:<a href="#section-1.6.4-8.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.5.2.1.2.1">
                      <p id="section-1.6.4-8.5.2.1.2.1.1">U+0020, U+0009, U+000A, U+000D.<a href="#section-1.6.4-8.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-1.6.4-8.5.2.2">
                  <p id="section-1.6.4-8.5.2.2.1">Optionally treat U+00A0 as whitespace, if done consistently.<a href="#section-1.6.4-8.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.6.4-8.5.2.3">
                  <p id="section-1.6.4-8.5.2.3.1">Replace each maximal run of W (and optional NBSP) with a single U+0020 SPACE.<a href="#section-1.6.4-8.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-1.6.4-8.6">
              <p id="section-1.6.4-8.6.1">Trim:<a href="#section-1.6.4-8.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.6.4-8.6.2.1">
                  <p id="section-1.6.4-8.6.2.1.1">Remove leading and trailing SPACE (U+0020).<a href="#section-1.6.4-8.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="section-1.6.4-9">The result is the normalized string N(S).<a href="#section-1.6.4-9" class="pilcrow">¶</a></p>
<p id="section-1.6.4-10">Details, examples, and conformance language are in Appendix A.<a href="#section-1.6.4-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="m-sitemap-format-and-semantics">
<section id="section-1.7">
        <h3 id="name-m-sitemap-format-and-semant">
<a href="#section-1.7" class="section-number selfRef">1.7. </a><a href="#name-m-sitemap-format-and-semant" class="section-name selfRef">M-Sitemap Format and Semantics</a>
        </h3>
<div id="m-sitemap-json-structure">
<section id="section-1.7.1">
          <h4 id="name-m-sitemap-json-structure">
<a href="#section-1.7.1" class="section-number selfRef">1.7.1. </a><a href="#name-m-sitemap-json-structure" class="section-name selfRef">M-Sitemap JSON Structure</a>
          </h4>
<p id="section-1.7.1-1">The M-Sitemap is a JSON object that lists TCT-enabled resources.<a href="#section-1.7.1-1" class="pilcrow">¶</a></p>
<p id="section-1.7.1-2">Fields:<a href="#section-1.7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.1">
              <p id="section-1.7.1-3.1.1"><code>version</code> (integer, REQUIRED)<a href="#section-1.7.1-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.1.2.1">
                  <p id="section-1.7.1-3.1.2.1.1">M-Sitemap format version. Initial value: 1.<a href="#section-1.7.1-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.7.1-3.2">
              <p id="section-1.7.1-3.2.1"><code>profile</code> (string, RECOMMENDED)<a href="#section-1.7.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.2.2.1">
                  <p id="section-1.7.1-3.2.2.1.1">Profile identifier, e.g., <code>tct-1</code>.<a href="#section-1.7.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.7.1-3.3">
              <p id="section-1.7.1-3.3.1"><code>items</code> (array of objects, REQUIRED)<a href="#section-1.7.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.3.2.1">
                  <p id="section-1.7.1-3.3.2.1.1">Each item:<a href="#section-1.7.1-3.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.3.2.1.2.1">
                      <p id="section-1.7.1-3.3.2.1.2.1.1"><code>cUrl</code> (string, REQUIRED)<a href="#section-1.7.1-3.3.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.3.2.1.2.1.2.1">
                          <p id="section-1.7.1-3.3.2.1.2.1.2.1.1">Canonical URL.<a href="#section-1.7.1-3.3.2.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal" id="section-1.7.1-3.3.2.1.2.2">
                      <p id="section-1.7.1-3.3.2.1.2.2.1"><code>mUrl</code> (string, REQUIRED)<a href="#section-1.7.1-3.3.2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.3.2.1.2.2.2.1">
                          <p id="section-1.7.1-3.3.2.1.2.2.2.1.1">M-URL of the JSON representation.<a href="#section-1.7.1-3.3.2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal" id="section-1.7.1-3.3.2.1.2.3">
                      <p id="section-1.7.1-3.3.2.1.2.3.1"><code>etag</code> (string, REQUIRED)<a href="#section-1.7.1-3.3.2.1.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.1-3.3.2.1.2.3.2.1">
                          <p id="section-1.7.1-3.3.2.1.2.3.2.1.1">Strong validator identifier, equal to the M-URL ETag value without quotes.<a href="#section-1.7.1-3.3.2.1.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                        <li class="normal" id="section-1.7.1-3.3.2.1.2.3.2.2">
                          <p id="section-1.7.1-3.3.2.1.2.3.2.2.1">MUST be <code>sha256-</code> followed by the 64-hex digest used in Section 6.2.<a href="#section-1.7.1-3.3.2.1.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.7.1-4">Example:<a href="#section-1.7.1-4" class="pilcrow">¶</a></p>
<p id="section-1.7.1-5"><code>json
{
  "version": 1,
  "profile": "tct-1",
  "items": [
    {
      "cUrl": "https://example.com/post/",
      "mUrl": "https://example.com/post/llm.json",
      "etag": "sha256-2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7"
    }
  ]
}
</code><a href="#section-1.7.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-response-for-m-sitemap">
<section id="section-1.7.2">
          <h4 id="name-http-response-for-m-sitemap">
<a href="#section-1.7.2" class="section-number selfRef">1.7.2. </a><a href="#name-http-response-for-m-sitemap" class="section-name selfRef">HTTP Response for M-Sitemap</a>
          </h4>
<p id="section-1.7.2-1">The M-Sitemap:<a href="#section-1.7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.2-2.1">
              <p id="section-1.7.2-2.1.1">MUST use:<a href="#section-1.7.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.2-2.1.2.1">
                  <p id="section-1.7.2-2.1.2.1.1"><code>Content-Type: application/json; charset=utf-8</code><a href="#section-1.7.2-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.7.2-2.2">
              <p id="section-1.7.2-2.2.1">SHOULD use cache directives that encourage timely revalidation, for example:<a href="#section-1.7.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.2-2.2.2.1">
                  <p id="section-1.7.2-2.2.2.1.1"><code>Cache-Control: max-age=0, must-revalidate</code>, or<a href="#section-1.7.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.7.2-2.2.2.2">
                  <p id="section-1.7.2-2.2.2.2.1">a short max-age value appropriate to the site's update frequency.<a href="#section-1.7.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.7.2-2.3">
              <p id="section-1.7.2-2.3.1">SHOULD include:<a href="#section-1.7.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.2-2.3.2.1">
                  <p id="section-1.7.2-2.3.2.1.1"><code>Vary: Accept-Encoding</code><a href="#section-1.7.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="parity-semantics">
<section id="section-1.7.3">
          <h4 id="name-parity-semantics">
<a href="#section-1.7.3" class="section-number selfRef">1.7.3. </a><a href="#name-parity-semantics" class="section-name selfRef">Parity Semantics</a>
          </h4>
<p id="section-1.7.3-1">Design intent:<a href="#section-1.7.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.3-2.1">
              <p id="section-1.7.3-2.1.1">M-Sitemap <code>etag</code> values SHOULD match the current strong ETag values of their corresponding M-URLs.<a href="#section-1.7.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.7.3-3">Requirements:<a href="#section-1.7.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.3-4.1">
              <p id="section-1.7.3-4.1.1">Publishers MUST compute <code>etag</code> values using the same algorithm as Section 6.2.<a href="#section-1.7.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.7.3-4.2">
              <p id="section-1.7.3-4.2.1">Publishers SHOULD keep M-Sitemap <code>etag</code> values in sync with M-URL ETags.<a href="#section-1.7.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.7.3-4.3">
              <p id="section-1.7.3-4.3.1">Transient mismatches (due to non-atomic updates, caches, or propagation delays) MAY occur.<a href="#section-1.7.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.7.3-5">Client behavior:<a href="#section-1.7.3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7.3-6.1">
              <p id="section-1.7.3-6.1.1">Clients SHOULD treat M-Sitemap <code>etag</code> as a hint for change detection.<a href="#section-1.7.3-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.7.3-6.2">
              <p id="section-1.7.3-6.2.1">Clients MAY compare <code>etag</code> with the M-URL ETag.<a href="#section-1.7.3-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.7.3-6.3">
              <p id="section-1.7.3-6.3.1">Clients MUST NOT treat mismatches alone as protocol errors.<a href="#section-1.7.3-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.7.3-6.4">
              <p id="section-1.7.3-6.4.1">In case of mismatch, clients SHOULD fall back to standard conditional requests on the M-URL and treat the M-Sitemap etag as an advisory signal only.<a href="#section-1.7.3-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.7.3-7">Strong ETag values for M-URLs and etag values in the M-Sitemap are scoped to the origin that serves them. Clients MUST NOT assume that identical validator values observed on different origins imply identical content.<a href="#section-1.7.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-behavior">
<section id="section-1.8">
        <h3 id="name-client-behavior">
<a href="#section-1.8" class="section-number selfRef">1.8. </a><a href="#name-client-behavior" class="section-name selfRef">Client Behavior</a>
        </h3>
<div id="zero-fetch-optimization">
<section id="section-1.8.1">
          <h4 id="name-zero-fetch-optimization">
<a href="#section-1.8.1" class="section-number selfRef">1.8.1. </a><a href="#name-zero-fetch-optimization" class="section-name selfRef">Zero-Fetch Optimization</a>
          </h4>
<p id="section-1.8.1-1">A typical TCT-aware client:<a href="#section-1.8.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.8.1-2">
<li id="section-1.8.1-2.1">
              <p id="section-1.8.1-2.1.1">Fetches <code>/</code> and discovers the M-Sitemap via <code>Link</code>.<a href="#section-1.8.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.8.1-2.2">
              <p id="section-1.8.1-2.2.1">Fetches the M-Sitemap.<a href="#section-1.8.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-1.8.1-2.3">
              <p id="section-1.8.1-2.3.1">For each item <code>(cUrl, mUrl, etag)</code>:<a href="#section-1.8.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.1">
                  <p id="section-1.8.1-2.3.2.1.1">If it has a cached ETag for <code>mUrl</code>:<a href="#section-1.8.1-2.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.1.2.1">
                      <p id="section-1.8.1-2.3.2.1.2.1.1">If cached ETag equals sitemap <code>etag</code>:<a href="#section-1.8.1-2.3.2.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.1.2.1.2.1">
                          <p id="section-1.8.1-2.3.2.1.2.1.2.1.1">MAY skip fetching <code>mUrl</code> (zero-fetch).<a href="#section-1.8.1-2.3.2.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      </ul>
</li>
                    <li class="normal" id="section-1.8.1-2.3.2.1.2.2">
                      <p id="section-1.8.1-2.3.2.1.2.2.1">Otherwise:<a href="#section-1.8.1-2.3.2.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.1.2.2.2.1">
                          <p id="section-1.8.1-2.3.2.1.2.2.2.1.1">SHOULD issue conditional GET:<a href="#section-1.8.1-2.3.2.1.2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.1.2.2.2.1.2.1">
                              <p id="section-1.8.1-2.3.2.1.2.2.2.1.2.1.1"><code>GET mUrl</code><a href="#section-1.8.1-2.3.2.1.2.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                            <li class="normal" id="section-1.8.1-2.3.2.1.2.2.2.1.2.2">
                              <p id="section-1.8.1-2.3.2.1.2.2.2.1.2.2.1"><code>If-None-Match: "sha256-..."</code>.<a href="#section-1.8.1-2.3.2.1.2.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                          </ul>
</li>
                      </ul>
</li>
                  </ul>
</li>
                <li class="normal" id="section-1.8.1-2.3.2.2">
                  <p id="section-1.8.1-2.3.2.2.1">If no cached ETag:<a href="#section-1.8.1-2.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.1-2.3.2.2.2.1">
                      <p id="section-1.8.1-2.3.2.2.2.1.1">SHOULD fetch <code>mUrl</code> with GET.<a href="#section-1.8.1-2.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-1.8.1-2.3.2.2.2.2">
                      <p id="section-1.8.1-2.3.2.2.2.2.1">MAY include <code>If-None-Match</code> using sitemap <code>etag</code> as hint.<a href="#section-1.8.1-2.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
          </ol>
<p id="section-1.8.1-3">This enables large reductions in redundant fetches.<a href="#section-1.8.1-3" class="pilcrow">¶</a></p>
<p id="section-1.8.1-4">This optimization is OPTIONAL. Clients that prefer strict HTTP cache validation MAY always perform a conditional GET with If-None-Match on M-URLs instead of relying solely on M-Sitemap etag hints.<a href="#section-1.8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conditional-requests-to-m-urls">
<section id="section-1.8.2">
          <h4 id="name-conditional-requests-to-m-u">
<a href="#section-1.8.2" class="section-number selfRef">1.8.2. </a><a href="#name-conditional-requests-to-m-u" class="section-name selfRef">Conditional Requests to M-URLs</a>
          </h4>
<p id="section-1.8.2-1">M-URLs implementing TCT:<a href="#section-1.8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.2-2.1">
              <p id="section-1.8.2-2.1.1">MUST support <code>If-None-Match</code> as defined in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-1.8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.8.2-3">Specifically:<a href="#section-1.8.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.2-4.1">
              <p id="section-1.8.2-4.1.1">If <code>If-None-Match</code> matches the current strong ETag:<a href="#section-1.8.2-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.2-4.1.2.1">
                  <p id="section-1.8.2-4.1.2.1.1">Respond with <code>304 Not Modified</code>, no body.<a href="#section-1.8.2-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.8.2-4.2">
              <p id="section-1.8.2-4.2.1">Otherwise:<a href="#section-1.8.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.2-4.2.2.1">
                  <p id="section-1.8.2-4.2.2.1.1">Respond with <code>200 OK</code> and the JSON representation.<a href="#section-1.8.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.8.2-5">If both <code>If-None-Match</code> and <code>If-Modified-Since</code> are present:<a href="#section-1.8.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.2-6.1">
              <p id="section-1.8.2-6.1.1"><code>If-None-Match</code> MUST take precedence (per <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>).<a href="#section-1.8.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.8.2-7">Servers SHOULD send appropriate <code>Cache-Control</code> directives to encourage revalidation and safe caching.<a href="#section-1.8.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-head-optional">
<section id="section-1.8.3">
          <h4 id="name-use-of-head-optional">
<a href="#section-1.8.3" class="section-number selfRef">1.8.3. </a><a href="#name-use-of-head-optional" class="section-name selfRef">Use of HEAD (Optional)</a>
          </h4>
<p id="section-1.8.3-1">Clients MAY use <code>HEAD</code> on M-URLs as an optimization:<a href="#section-1.8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.3-2.1">
              <p id="section-1.8.3-2.1.1">If a HEAD response includes an <code>ETag</code> equal to the cached one, a GET may be skipped.<a href="#section-1.8.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.8.3-2.2">
              <p id="section-1.8.3-2.2.1">If HEAD is unreliable, clients SHOULD fall back to conditional GET.<a href="#section-1.8.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.8.3-3">Conditional GET with <code>If-None-Match</code> SHOULD be considered the primary mechanism.<a href="#section-1.8.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-validation-optional">
<section id="section-1.8.4">
          <h4 id="name-client-validation-optional">
<a href="#section-1.8.4" class="section-number selfRef">1.8.4. </a><a href="#name-client-validation-optional" class="section-name selfRef">Client Validation (Optional)</a>
          </h4>
<p id="section-1.8.4-1">For protocol correctness:<a href="#section-1.8.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.4-2.1">
              <p id="section-1.8.4-2.1.1">Clients are not required to implement the text normalization algorithm or to recompute validators.<a href="#section-1.8.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.8.4-2.2">
              <p id="section-1.8.4-2.2.1">Clients MAY treat ETags and sitemap <code>etag</code> values as opaque.<a href="#section-1.8.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.8.4-3">Clients MAY perform additional checks as desired, such as:<a href="#section-1.8.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.8.4-4.1">
              <p id="section-1.8.4-4.1.1">verifying that an M-URL includes <code>rel="canonical"</code> pointing at the expected C-URL;<a href="#section-1.8.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.8.4-4.2">
              <p id="section-1.8.4-4.2.1">checking M-Sitemap <code>etag</code> vs M-URL ETag parity;<a href="#section-1.8.4-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.8.4-4.3">
              <p id="section-1.8.4-4.3.1">recomputing hashes using the published algorithms.<a href="#section-1.8.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.8.4-5">Such additional checks are implementation choices and are out of scope for TCT compliance.<a href="#section-1.8.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-considerations-informative">
<section id="section-1.9">
        <h3 id="name-operational-considerations-">
<a href="#section-1.9" class="section-number selfRef">1.9. </a><a href="#name-operational-considerations-" class="section-name selfRef">Operational Considerations (Informative)</a>
        </h3>
<div id="deployment-with-cdns-and-proxies">
<section id="section-1.9.1">
          <h4 id="name-deployment-with-cdns-and-pr">
<a href="#section-1.9.1" class="section-number selfRef">1.9.1. </a><a href="#name-deployment-with-cdns-and-pr" class="section-name selfRef">Deployment with CDNs and Proxies</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-1.9.1-1.1">
              <p id="section-1.9.1-1.1.1">M-URLs and M-Sitemaps are ordinary cacheable JSON resources.<a href="#section-1.9.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.9.1-1.2">
              <p id="section-1.9.1-1.2.1">CDNs and reverse proxies:<a href="#section-1.9.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.1-1.2.2.1">
                  <p id="section-1.9.1-1.2.2.1.1">MAY cache them;<a href="#section-1.9.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.9.1-1.2.2.2">
                  <p id="section-1.9.1-1.2.2.2.1">SHOULD honor strong ETags and 304 responses.<a href="#section-1.9.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.9.1-1.3">
              <p id="section-1.9.1-1.3.1">Since ETags are based on uncompressed canonical JSON:<a href="#section-1.9.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.1-1.3.2.1">
                  <p id="section-1.9.1-1.3.2.1.1">Downstream compression does not invalidate validators.<a href="#section-1.9.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="large-sites-and-sharding">
<section id="section-1.9.2">
          <h4 id="name-large-sites-and-sharding">
<a href="#section-1.9.2" class="section-number selfRef">1.9.2. </a><a href="#name-large-sites-and-sharding" class="section-name selfRef">Large Sites and Sharding</a>
          </h4>
<p id="section-1.9.2-1">For very large sites:<a href="#section-1.9.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.2-2.1">
              <p id="section-1.9.2-2.1.1">Operators MAY create multiple M-Sitemaps (e.g., per section or date).<a href="#section-1.9.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.9.2-2.2">
              <p id="section-1.9.2-2.2.1">A primary M-Sitemap can list additional ones by convention.<a href="#section-1.9.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.9.2-2.3">
              <p id="section-1.9.2-2.3.1">This document does not standardize a JSON sitemap index; such work may be done separately.<a href="#section-1.9.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-1.9.2-3">A future revision of this specification or a separate document MAY define a JSON M-Sitemap index format, analogous to the XML Sitemap Index, to provide interoperable conventions for sharding and large-site discovery.<a href="#section-1.9.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-handling">
<section id="section-1.9.3">
          <h4 id="name-error-handling">
<a href="#section-1.9.3" class="section-number selfRef">1.9.3. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
          </h4>
<p id="section-1.9.3-1">Recommended behavior:<a href="#section-1.9.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.3-2.1">
              <p id="section-1.9.3-2.1.1">If the M-Sitemap is unavailable or invalid:<a href="#section-1.9.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.3-2.1.2.1">
                  <p id="section-1.9.3-2.1.2.1.1">Treat TCT as temporarily unavailable.<a href="#section-1.9.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.9.3-2.2">
              <p id="section-1.9.3-2.2.1">If an M-URL returns 4xx/5xx:<a href="#section-1.9.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.3-2.2.2.1">
                  <p id="section-1.9.3-2.2.2.1.1">Follow normal HTTP semantics for retries/backoff.<a href="#section-1.9.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.9.3-2.3">
              <p id="section-1.9.3-2.3.1">If the M-URL is persistently broken:<a href="#section-1.9.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.3-2.3.2.1">
                  <p id="section-1.9.3-2.3.2.1.1">Clients MAY ignore it and rely on the C-URL HTML, if appropriate.<a href="#section-1.9.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="backwards-compatibility">
<section id="section-1.9.4">
          <h4 id="name-backwards-compatibility">
<a href="#section-1.9.4" class="section-number selfRef">1.9.4. </a><a href="#name-backwards-compatibility" class="section-name selfRef">Backwards Compatibility</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-1.9.4-1.1">
              <p id="section-1.9.4-1.1.1">TCT is purely additive:<a href="#section-1.9.4-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.9.4-1.1.2.1">
                  <p id="section-1.9.4-1.1.2.1.1">It does not alter C-URL semantics.<a href="#section-1.9.4-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-1.9.4-1.1.2.2">
                  <p id="section-1.9.4-1.1.2.2.1">Non-participating clients see no change.<a href="#section-1.9.4-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.9.4-1.2">
              <p id="section-1.9.4-1.2.1">Operators can deploy TCT incrementally on selected resources.<a href="#section-1.9.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-1.10">
        <h3 id="name-security-considerations">
<a href="#section-1.10" class="section-number selfRef">1.10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
        </h3>
<p id="section-1.10-1">TCT builds directly on HTTP; most security considerations are inherited from <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> and <span>[<a href="#RFC9111" class="cite xref">RFC9111</a>]</span>.<a href="#section-1.10-1" class="pilcrow">¶</a></p>
<p id="section-1.10-2">Key points:<a href="#section-1.10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.1">
            <p id="section-1.10-3.1.1">HTTPS:<a href="#section-1.10-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.1.2.1">
                <p id="section-1.10-3.1.2.1.1">Publishers SHOULD serve M-URLs and M-Sitemaps over HTTPS.<a href="#section-1.10-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.10-3.1.2.2">
                <p id="section-1.10-3.1.2.2.1">Clients SHOULD validate TLS as usual.<a href="#section-1.10-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.2">
            <p id="section-1.10-3.2.1">Integrity:<a href="#section-1.10-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.2.2.1">
                <p id="section-1.10-3.2.2.1.1">Strong ETags identify specific representations but do not authenticate servers.<a href="#section-1.10-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.10-3.2.2.2">
                <p id="section-1.10-3.2.2.2.1">For stronger guarantees, publishers MAY use:<a href="#section-1.10-3.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.2.2.2.2.1">
                    <p id="section-1.10-3.2.2.2.2.1.1"><code>Content-Digest</code> headers (<span>[<a href="#RFC9530" class="cite xref">RFC9530</a>]</span>); and/or<a href="#section-1.10-3.2.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-1.10-3.2.2.2.2.2">
                    <p id="section-1.10-3.2.2.2.2.2.1">HTTP Message Signatures (<span>[<a href="#RFC9421" class="cite xref">RFC9421</a>]</span>).<a href="#section-1.10-3.2.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.3">
            <p id="section-1.10-3.3.1">Access control:<a href="#section-1.10-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.3.2.1">
                <p id="section-1.10-3.3.2.1.1">If a C-URL requires authentication, its corresponding M-URL SHOULD be similarly protected.<a href="#section-1.10-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.10-3.3.2.2">
                <p id="section-1.10-3.3.2.2.1">M-Sitemaps MUST NOT leak sensitive M-URLs or validators.<a href="#section-1.10-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.4">
            <p id="section-1.10-3.4.1">Cache poisoning:<a href="#section-1.10-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.4.2.1">
                <p id="section-1.10-3.4.2.1.1">Correct use of ETag and Cache-Control mitigates stale or mixed content.<a href="#section-1.10-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.10-3.4.2.2">
                <p id="section-1.10-3.4.2.2.1">Clients MUST treat JSON as untrusted data and validate/sanitize as appropriate.<a href="#section-1.10-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.5">
            <p id="section-1.10-3.5.1">Privacy:<a href="#section-1.10-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.5.2.1">
                <p id="section-1.10-3.5.2.1.1">As with any sitemap, listing URLs in an M-Sitemap can reveal site structure.<a href="#section-1.10-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-1.10-3.5.2.2">
                <p id="section-1.10-3.5.2.2.1">Publishers concerned about this SHOULD limit entries or restrict access.<a href="#section-1.10-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.6">
            <p id="section-1.10-3.6.1">Origin trust:<a href="#section-1.10-3.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.6.2.1">
                <p id="section-1.10-3.6.2.1.1">Clients that consume M-Sitemaps and M-URLs inherently trust the origin in the same way they trust HTML pages or XML Sitemaps from that origin. A compromised or misconfigured origin can advertise incorrect mappings; this is not a new class of attack introduced by TCT.<a href="#section-1.10-3.6.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.10-3.7">
            <p id="section-1.10-3.7.1">Intermediaries:<a href="#section-1.10-3.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.10-3.7.2.1">
                <p id="section-1.10-3.7.2.1.1">Deployments SHOULD ensure that CDNs and other intermediaries do not strip or rewrite strong ETags on M-URLs or M-Sitemaps, as doing so can interfere with correct validation and zero-fetch behavior.<a href="#section-1.10-3.7.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-1.11">
        <h3 id="name-iana-considerations">
<a href="#section-1.11" class="section-number selfRef">1.11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
        </h3>
<p id="section-1.11-1">This document has no IANA actions.<a href="#section-1.11-1" class="pilcrow">¶</a></p>
<p id="section-1.11-2">A future revision or separate document MAY define and register:<a href="#section-1.11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.11-3.1">
            <p id="section-1.11-3.1.1">a well-known URI for TCT M-Sitemaps; and/or<a href="#section-1.11-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.11-3.2">
            <p id="section-1.11-3.2.1">a dedicated media type or <code>profile</code> parameter for TCT JSON.<a href="#section-1.11-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.11-4">Such registrations are intentionally out of scope for this version.<a href="#section-1.11-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-2">
      <h2 id="name-references">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-2.1">
        <h3 id="name-normative-references">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8785">[RFC8785]</dt>
        <dd>
<span class="refAuthor">Rundgren, A.</span>, <span class="refAuthor">Jordan, B.</span>, and <span class="refAuthor">S. Erdtman</span>, <span class="refTitle">"JSON Canonicalization Scheme (JCS)"</span>, <span class="seriesInfo">RFC 8785</span>, <span class="seriesInfo">DOI 10.17487/RFC8785</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8785">https://www.rfc-editor.org/info/rfc8785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9111">[RFC9111]</dt>
      <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Caching"</span>, <span class="seriesInfo">STD 98</span>, <span class="seriesInfo">RFC 9111</span>, <span class="seriesInfo">DOI 10.17487/RFC9111</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9111">https://www.rfc-editor.org/info/rfc9111</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-2.2">
        <h3 id="name-informative-references">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC6596">[RFC6596]</dt>
        <dd>
<span class="refAuthor">Ohye, M.</span> and <span class="refAuthor">J. Kupke</span>, <span class="refTitle">"The Canonical Link Relation"</span>, <span class="seriesInfo">RFC 6596</span>, <span class="seriesInfo">DOI 10.17487/RFC6596</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6596">https://www.rfc-editor.org/info/rfc6596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9421">[RFC9421]</dt>
        <dd>
<span class="refAuthor">Backman, A., Ed.</span>, <span class="refAuthor">Richer, J., Ed.</span>, and <span class="refAuthor">M. Sporny</span>, <span class="refTitle">"HTTP Message Signatures"</span>, <span class="seriesInfo">RFC 9421</span>, <span class="seriesInfo">DOI 10.17487/RFC9421</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9530">[RFC9530]</dt>
      <dd>
<span class="refAuthor">Polli, R.</span> and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"Digest Fields"</span>, <span class="seriesInfo">RFC 9530</span>, <span class="seriesInfo">DOI 10.17487/RFC9530</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9530">https://www.rfc-editor.org/info/rfc9530</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="appendix-a-normalization-test-vectors">
<section id="appendix-A">
      <h2 id="name-appendix-a-normalization-te">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-appendix-a-normalization-te" class="section-name selfRef">Appendix A. Normalization Test Vectors</a>
      </h2>
<p id="appendix-A-1">This appendix provides test vectors for implementations that claim conformance to the normalization algorithm (Section 6.4).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><strong>Conformance Requirement:</strong> Implementations claiming normalization support MUST produce the outputs specified below for all test inputs.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3"><strong>Test Format:</strong> Each test shows:
- Input string
- Output after each normalization step
- Final SHA-256 hash (computed over UTF-8 bytes of final output)<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="a1-basic-ascii">
<section id="appendix-A.1">
        <h3 id="name-a1-basic-ascii">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-a1-basic-ascii" class="section-name selfRef">A.1. Basic ASCII</a>
        </h3>
<p id="appendix-A.1-1"><strong>Test 1: Simple ASCII text</strong>
- Input: <code>"Hello World"</code>
- After step 1 (HTML decode): <code>"Hello World"</code>
- After step 2 (NFKC): <code>"Hello World"</code>
- After step 3 (casefold): <code>"hello world"</code>
- After step 4 (control chars): <code>"hello world"</code>
- After step 5 (whitespace): <code>"hello world"</code>
- After step 6 (trim): <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2"><strong>Test 2: Leading/trailing whitespace</strong>
- Input: <code>"  Hello World  "</code>
- After step 1: <code>"  Hello World  "</code>
- After step 2: <code>"  Hello World  "</code>
- After step 3: <code>"  hello world  "</code>
- After step 4: <code>"  hello world  "</code>
- After step 5: <code>" hello world "</code>
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3"><strong>Test 3: Multiple spaces</strong>
- Input: <code>"Hello    World"</code>
- After step 1: <code>"Hello    World"</code>
- After step 2: <code>"Hello    World"</code>
- After step 3: <code>"hello    world"</code>
- After step 4: <code>"hello    world"</code>
- After step 5: <code>"hello world"</code>
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div id="a2-html-entities">
<section id="appendix-A.1.1">
          <h4 id="name-a2-html-entities">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-a2-html-entities" class="section-name selfRef">A.2. HTML Entities</a>
          </h4>
<p id="appendix-A.1.1-1"><strong>Test 4: Common HTML entities</strong>
- Input: <code>"Hello &amp;amp; goodbye"</code>
- After step 1: <code>"Hello &amp; goodbye"</code>
- After step 2: <code>"Hello &amp; goodbye"</code>
- After step 3: <code>"hello &amp; goodbye"</code>
- After step 4: <code>"hello &amp; goodbye"</code>
- After step 5: <code>"hello &amp; goodbye"</code>
- After step 6: <code>"hello &amp; goodbye"</code>
- SHA-256: <code>da73536eaa9c427f3189de5b6371d798193e98f3c31df8bef710bba835e8c621</code><a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2"><strong>Test 5: Angle brackets</strong>
- Input: <code>"&amp;lt;tag&amp;gt;"</code>
- After step 1: <code>"&lt;tag&gt;"</code>
- After step 2: <code>"&lt;tag&gt;"</code>
- After step 3: <code>"&lt;tag&gt;"</code>
- After step 4: <code>"&lt;tag&gt;"</code>
- After step 5: <code>"&lt;tag&gt;"</code>
- After step 6: <code>"&lt;tag&gt;"</code>
- SHA-256: <code>c81ef880af0fcfef49e1b45c3690a1666c47d9e064b7eaead2af09bb78884dcd</code><a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-3"><strong>Test 6: Quotes</strong>
- Input: <code>"&amp;quot;quoted&amp;quot;"</code>
- After step 1: <code>"\"quoted\""</code>
- After step 2: <code>"\"quoted\""</code>
- After step 3: <code>"\"quoted\""</code>
- After step 4: <code>"\"quoted\""</code>
- After step 5: <code>"\"quoted\""</code>
- After step 6: <code>"\"quoted\""</code>
- SHA-256: <code>272fca25899893eeb27b89583d5c81b8a4ac5af4d1e37e3909d879947303c1c5</code><a href="#appendix-A.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a3-unicode-normalization-nfkc">
<section id="appendix-A.1.2">
          <h4 id="name-a3-unicode-normalization-nf">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-a3-unicode-normalization-nf" class="section-name selfRef">A.3. Unicode Normalization (NFKC)</a>
          </h4>
<p id="appendix-A.1.2-1"><strong>Test 7: Composed vs decomposed é</strong>
- Input (composed): <code>"Café"</code> (U+00E9)
- After step 1: <code>"Café"</code>
- After step 2 (NFKC): <code>"Café"</code> (normalized to composed form)
- After step 3: <code>"café"</code>
- After step 4: <code>"café"</code>
- After step 5: <code>"café"</code>
- After step 6: <code>"café"</code>
- SHA-256: <code>850f7dc43910ff890f8879c0ed26fe697c93a067ad93a7d50f466a7028a9bf4e</code><a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2"><strong>Test 7b: Decomposed form (should produce same result)</strong>
- Input (decomposed): <code>"Cafe\u0301"</code> (e + combining acute)
- After step 2 (NFKC): <code>"Café"</code> (normalized to composed)
- Final result: Same as Test 7
- SHA-256: <code>850f7dc43910ff890f8879c0ed26fe697c93a067ad93a7d50f466a7028a9bf4e</code> (same as Test 7)<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-3"><strong>Test 8: Full-width characters</strong>
- Input: <code>"ＨＥＬＬＯ"</code> (full-width Latin)
- After step 1: <code>"ＨＥＬＬＯ"</code>
- After step 2 (NFKC): <code>"HELLO"</code> (converted to half-width)
- After step 3: <code>"hello"</code>
- After step 4: <code>"hello"</code>
- After step 5: <code>"hello"</code>
- After step 6: <code>"hello"</code>
- SHA-256: <code>2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824</code><a href="#appendix-A.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a4-case-folding-edge-cases">
<section id="appendix-A.1.3">
          <h4 id="name-a4-case-folding-edge-cases">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-a4-case-folding-edge-cases" class="section-name selfRef">A.4. Case Folding Edge Cases</a>
          </h4>
<p id="appendix-A.1.3-1"><strong>Test 9: German sharp S</strong>
- Input: <code>"Straße"</code>
- After step 1: <code>"Straße"</code>
- After step 2: <code>"Straße"</code>
- After step 3 (casefold): <code>"strasse"</code> (ß -&gt; ss)
- After step 4: <code>"strasse"</code>
- After step 5: <code>"strasse"</code>
- After step 6: <code>"strasse"</code>
- SHA-256: <code>16d96952087774fee069b7585d3991b24d90c181c09b2129b4908c35baa7f0c0</code><a href="#appendix-A.1.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-2"><strong>Test 10: Turkish İ (dotted capital I)</strong>
- Input: <code>"İstanbul"</code>
- After step 1: <code>"İstanbul"</code>
- After step 2: <code>"İstanbul"</code>
- After step 3 (casefold): <code>"i\u0307stanbul"</code> (locale-independent)
- After step 4: <code>"i\u0307stanbul"</code>
- After step 5: <code>"i\u0307stanbul"</code>
- After step 6: <code>"i\u0307stanbul"</code>
- SHA-256: <code>4a4df120f7d1f3c286f58651abfcec2aade892ace635f96f02b946c96e6e1f86</code><a href="#appendix-A.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a5-control-characters">
<section id="appendix-A.1.4">
          <h4 id="name-a5-control-characters">
<a href="#appendix-A.1.4" class="section-number selfRef">A.1.4. </a><a href="#name-a5-control-characters" class="section-name selfRef">A.5. Control Characters</a>
          </h4>
<p id="appendix-A.1.4-1"><strong>Test 11: Embedded tab</strong>
- Input: <code>"Hello\tWorld"</code>
- After step 1: <code>"Hello\tWorld"</code>
- After step 2: <code>"Hello\tWorld"</code>
- After step 3: <code>"hello\tworld"</code>
- After step 4: <code>"hello\tworld"</code> (tab preserved)
- After step 5: <code>"hello world"</code> (tab -&gt; space)
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.4-2"><strong>Test 12: Embedded newline</strong>
- Input: <code>"Hello\nWorld"</code>
- After step 1: <code>"Hello\nWorld"</code>
- After step 2: <code>"Hello\nWorld"</code>
- After step 3: <code>"hello\nworld"</code>
- After step 4: <code>"hello\nworld"</code> (newline preserved)
- After step 5: <code>"hello world"</code> (newline -&gt; space)
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1.4-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.4-3"><strong>Test 13: Control character (BEL)</strong>
- Input: <code>"Hello\u0007World"</code> (U+0007 = BEL)
- After step 1: <code>"Hello\u0007World"</code>
- After step 2: <code>"Hello\u0007World"</code>
- After step 3: <code>"hello\u0007world"</code>
- After step 4: <code>"helloworld"</code> (control char removed)
- After step 5: <code>"helloworld"</code>
- After step 6: <code>"helloworld"</code>
- SHA-256: <code>936a185caaa266bb9cbe981e9e05cb78cd732b0b3280eb944412bb6f8f8f07af</code><a href="#appendix-A.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a6-whitespace-edge-cases">
<section id="appendix-A.1.5">
          <h4 id="name-a6-whitespace-edge-cases">
<a href="#appendix-A.1.5" class="section-number selfRef">A.1.5. </a><a href="#name-a6-whitespace-edge-cases" class="section-name selfRef">A.6. Whitespace Edge Cases</a>
          </h4>
<p id="appendix-A.1.5-1"><strong>Test 14: Non-breaking space (NBSP)</strong>
- Input: <code>"Hello\u00A0World"</code> (U+00A0 = NBSP)
- After step 1: <code>"Hello\u00A0World"</code>
- After step 2: <code>"Hello\u00A0World"</code>
- After step 3: <code>"hello\u00A0world"</code>
- After step 4: <code>"hello\u00A0world"</code>
- After step 5: <code>"hello world"</code> (NBSP -&gt; space, if treating NBSP as whitespace)
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.5-2"><strong>Note:</strong> Step 5 behavior for NBSP is implementation-defined per Section 6.4 ("Optionally treat U+00A0 as whitespace, if done consistently"). This test assumes NBSP is treated as whitespace.<a href="#appendix-A.1.5-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.5-3"><strong>Test 15: Mixed whitespace</strong>
- Input: <code>"Hello \t\n World"</code>
- After step 1: <code>"Hello \t\n World"</code>
- After step 2: <code>"Hello \t\n World"</code>
- After step 3: <code>"hello \t\n world"</code>
- After step 4: <code>"hello \t\n world"</code>
- After step 5: <code>"hello world"</code>
- After step 6: <code>"hello world"</code>
- SHA-256: <code>b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9</code><a href="#appendix-A.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a7-empty-and-edge-cases">
<section id="appendix-A.1.6">
          <h4 id="name-a7-empty-and-edge-cases">
<a href="#appendix-A.1.6" class="section-number selfRef">A.1.6. </a><a href="#name-a7-empty-and-edge-cases" class="section-name selfRef">A.7. Empty and Edge Cases</a>
          </h4>
<p id="appendix-A.1.6-1"><strong>Test 16: Empty string</strong>
- Input: <code>""</code>
- After all steps: <code>""</code>
- SHA-256: <code>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</code><a href="#appendix-A.1.6-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.6-2"><strong>Test 17: Whitespace only</strong>
- Input: <code>"   "</code>
- After step 1: <code>"   "</code>
- After step 2: <code>"   "</code>
- After step 3: <code>"   "</code>
- After step 4: <code>"   "</code>
- After step 5: <code>" "</code>
- After step 6: <code>""</code> (trimmed)
- SHA-256: <code>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</code><a href="#appendix-A.1.6-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.6-3"><strong>Test 18: Single character</strong>
- Input: <code>"A"</code>
- After step 1: <code>"A"</code>
- After step 2: <code>"A"</code>
- After step 3: <code>"a"</code>
- After step 4: <code>"a"</code>
- After step 5: <code>"a"</code>
- After step 6: <code>"a"</code>
- SHA-256: <code>ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb</code><a href="#appendix-A.1.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a8-complex-real-world-examples">
<section id="appendix-A.1.7">
          <h4 id="name-a8-complex-real-world-examp">
<a href="#appendix-A.1.7" class="section-number selfRef">A.1.7. </a><a href="#name-a8-complex-real-world-examp" class="section-name selfRef">A.8. Complex Real-World Examples</a>
          </h4>
<p id="appendix-A.1.7-1"><strong>Test 19: Article excerpt</strong>
- Input: <code>"The café's "special" offer: 50% off!"</code>
- Expected output after normalization: <code>the café's "special" offer: 50% off!</code>
- SHA-256: <code>25cdbe2315674d38ddaf1df6fe7ccd494ce89efebe8a3b5285742e57e7367545</code><a href="#appendix-A.1.7-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.7-2"><strong>Test 20: Unicode mixed with entities</strong>
- Input: <code>"Cliché &amp;amp; résumé"</code>
- Expected output after normalization: <code>cliché &amp; résumé</code>
- SHA-256: <code>7d56f360edd22f7be0bc0f126d45481df83e8afc68b83788cf37544c4ee6ce21</code><a href="#appendix-A.1.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a9-implementation-notes">
<section id="appendix-A.1.8">
          <h4 id="name-a9-implementation-notes">
<a href="#appendix-A.1.8" class="section-number selfRef">A.1.8. </a><a href="#name-a9-implementation-notes" class="section-name selfRef">A.9. Implementation Notes</a>
          </h4>
<p id="appendix-A.1.8-1"><strong>Computing SHA-256:</strong>
- Encode the final normalized string as UTF-8 bytes
- Compute SHA-256 over those bytes
- Express result as 64 lowercase hex characters<a href="#appendix-A.1.8-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.8-2"><strong>Test Vector Validation:</strong>
- Implementations claiming normalization support MUST produce the SHA-256 hashes specified above
- The seven "hello world" variants (Tests 1, 2, 3, 11, 12, 14, 15) all normalize to identical output (<code>"hello world"</code>), demonstrating whitespace normalization equivalence
- Tests 7 and 7b demonstrate NFKC combining character handling (both produce identical hashes)<a href="#appendix-A.1.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-b-example-flows-informative">
<section id="appendix-A.2">
        <h3 id="name-appendix-b-example-flows-in">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-appendix-b-example-flows-in" class="section-name selfRef">Appendix B. Example Flows (Informative)</a>
        </h3>
<p id="appendix-A.2-1">This appendix illustrates TCT discovery and fetch patterns.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div id="b1-initial-discovery-and-first-fetch">
<section id="appendix-A.2.1">
          <h4 id="name-b1-initial-discovery-and-fi">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-b1-initial-discovery-and-fi" class="section-name selfRef">B.1. Initial Discovery and First Fetch</a>
          </h4>
<p id="appendix-A.2.1-1"><strong>Scenario:</strong> Client visits origin for the first time.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-2">```
1. Client -&gt; Server: GET / HTTP/1.1
                     Host: example.com<a href="#appendix-A.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.1-3">
<li id="appendix-A.2.1-3.1">
              <p id="appendix-A.2.1-3.1.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Link: &lt;/llm-pages.json&gt;; rel="index"; type="application/json"
                  Content-Type: text/html<a href="#appendix-A.2.1-3.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.1-3.1.2">
<pre>
              [HTML body...]
</pre><a href="#appendix-A.2.1-3.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.1-3.2">
              <p id="appendix-A.2.1-3.2.1">Client -&gt; Server: GET /llm-pages.json HTTP/1.1
                  Host: example.com<a href="#appendix-A.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.1-3.3">
              <p id="appendix-A.2.1-3.3.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Content-Type: application/json; charset=utf-8
                  Cache-Control: max-age=0, must-revalidate<a href="#appendix-A.2.1-3.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.1-3.3.2">
<pre>
              {
                "version": 1,
                "profile": "tct-1",
                "items": [
                  {
                    "cUrl": "https://example.com/article/",
                    "mUrl": "https://example.com/article/llm.json",
                    "etag": "sha256-abc123..."
                  }
                ]
              }
</pre><a href="#appendix-A.2.1-3.3.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.1-3.4">
              <p id="appendix-A.2.1-3.4.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1
                  Host: example.com<a href="#appendix-A.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.1-3.5">
              <p id="appendix-A.2.1-3.5.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Content-Type: application/json; charset=utf-8
                  ETag: "sha256-abc123..."
                  Link: <a href="https://example.com/article/">https://example.com/article/</a>; rel="canonical"<a href="#appendix-A.2.1-3.5.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.1-3.5.2">
<pre>
              {
                "profile": "tct-1",
                "canonical_url": "https://example.com/article/",
                "title": "Article Title",
                "content": "Article content...",
                "hash": "sha256-abc123..."
              } ```
</pre><a href="#appendix-A.2.1-3.5.2" class="pilcrow">¶</a>
</div>
</li>
          </ol>
<p id="appendix-A.2.1-4"><strong>Client actions after step 6:</strong>
- Stores M-URL content locally
- Caches ETag <code>"sha256-abc123..."</code> for future revalidation<a href="#appendix-A.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b2-zero-fetch-optimization-content-unchanged">
<section id="appendix-A.2.2">
          <h4 id="name-b2-zero-fetch-optimization-">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-b2-zero-fetch-optimization-" class="section-name selfRef">B.2. Zero-Fetch Optimization (Content Unchanged)</a>
          </h4>
<p id="appendix-A.2.2-1"><strong>Scenario:</strong> Client returns after some time; content hasn't changed.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-2">```
1. Client -&gt; Server: GET /llm-pages.json HTTP/1.1
                     Host: example.com<a href="#appendix-A.2.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.2-3">
<li id="appendix-A.2.2-3.1">
              <p id="appendix-A.2.2-3.1.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Content-Type: application/json; charset=utf-8<a href="#appendix-A.2.2-3.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.2-3.1.2">
<pre>
              {
                "version": 1,
                "items": [
                  {
                    "cUrl": "https://example.com/article/",
                    "mUrl": "https://example.com/article/llm.json",
                    "etag": "sha256-abc123..."
                  }
                ]
              }
</pre><a href="#appendix-A.2.2-3.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.2-3.2">
              <p id="appendix-A.2.2-3.2.1">Client local comparison:<a href="#appendix-A.2.2-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2-3.2.2.1">
                  <p id="appendix-A.2.2-3.2.2.1.1">Sitemap etag: "sha256-abc123..."<a href="#appendix-A.2.2-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.2-3.2.2.2">
                  <p id="appendix-A.2.2-3.2.2.2.1">Cached ETag:  "sha256-abc123..."<a href="#appendix-A.2.2-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.2-3.2.2.3">
                  <p id="appendix-A.2.2-3.2.2.3.1">Match! -&gt; Skip fetch entirely (zero-fetch)<a href="#appendix-A.2.2-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="appendix-A.2.2-3.3">
              <p id="appendix-A.2.2-3.3.1">Client uses locally cached content for /article/
```<a href="#appendix-A.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="appendix-A.2.2-4"><strong>Result:</strong> Zero bytes transferred for M-URL; content known to be current.<a href="#appendix-A.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b3-conditional-request-content-unchanged">
<section id="appendix-A.2.3">
          <h4 id="name-b3-conditional-request-cont">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-b3-conditional-request-cont" class="section-name selfRef">B.3. Conditional Request (Content Unchanged)</a>
          </h4>
<p id="appendix-A.2.3-1"><strong>Scenario:</strong> Sitemap etag differs from cache, but actual content hasn't changed.<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-2">```
1. Client -&gt; Server: GET /llm-pages.json HTTP/1.1<a href="#appendix-A.2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.3-3">
<li id="appendix-A.2.3-3.1">
              <p id="appendix-A.2.3-3.1.1">Server -&gt; Client: [Sitemap shows etag: "sha256-def456..."]<a href="#appendix-A.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.3-3.2">
              <p id="appendix-A.2.3-3.2.1">Client comparison:<a href="#appendix-A.2.3-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.3-3.2.2.1">
                  <p id="appendix-A.2.3-3.2.2.1.1">Sitemap etag: "sha256-def456..." (different!)<a href="#appendix-A.2.3-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.3-3.2.2.2">
                  <p id="appendix-A.2.3-3.2.2.2.1">Cached ETag:  "sha256-abc123..."<a href="#appendix-A.2.3-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.3-3.2.2.3">
                  <p id="appendix-A.2.3-3.2.2.3.1">Mismatch -&gt; Must fetch, but use conditional request<a href="#appendix-A.2.3-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="appendix-A.2.3-3.3">
              <p id="appendix-A.2.3-3.3.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1
                  If-None-Match: "sha256-abc123..."<a href="#appendix-A.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.3-3.4">
              <p id="appendix-A.2.3-3.4.1">Server -&gt; Client: HTTP/1.1 304 Not Modified
                  ETag: "sha256-abc123..."<a href="#appendix-A.2.3-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.3-3.5">
              <p id="appendix-A.2.3-3.5.1">Client actions:<a href="#appendix-A.2.3-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.3-3.5.2.1">
                  <p id="appendix-A.2.3-3.5.2.1.1">Content unchanged; uses cached copy<a href="#appendix-A.2.3-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.3-3.5.2.2">
                  <p id="appendix-A.2.3-3.5.2.2.1">Notes: sitemap was stale/inconsistent; no protocol violation
```<a href="#appendix-A.2.3-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="appendix-A.2.3-4"><strong>Result:</strong> Small 304 response instead of full payload.<a href="#appendix-A.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b4-content-changed">
<section id="appendix-A.2.4">
          <h4 id="name-b4-content-changed">
<a href="#appendix-A.2.4" class="section-number selfRef">A.2.4. </a><a href="#name-b4-content-changed" class="section-name selfRef">B.4. Content Changed</a>
          </h4>
<p id="appendix-A.2.4-1"><strong>Scenario:</strong> Content has been updated.<a href="#appendix-A.2.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.4-2">```
1. Client -&gt; Server: GET /llm-pages.json HTTP/1.1<a href="#appendix-A.2.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.4-3">
<li id="appendix-A.2.4-3.1">
              <p id="appendix-A.2.4-3.1.1">Server -&gt; Client: [Sitemap shows etag: "sha256-xyz789..."]<a href="#appendix-A.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.4-3.2">
              <p id="appendix-A.2.4-3.2.1">Client comparison:<a href="#appendix-A.2.4-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.4-3.2.2.1">
                  <p id="appendix-A.2.4-3.2.2.1.1">Sitemap etag: "sha256-xyz789..." (different)<a href="#appendix-A.2.4-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.4-3.2.2.2">
                  <p id="appendix-A.2.4-3.2.2.2.1">Cached ETag:  "sha256-abc123..."<a href="#appendix-A.2.4-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.4-3.2.2.3">
                  <p id="appendix-A.2.4-3.2.2.3.1">Mismatch -&gt; Fetch with If-None-Match<a href="#appendix-A.2.4-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="appendix-A.2.4-3.3">
              <p id="appendix-A.2.4-3.3.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1
                  If-None-Match: "sha256-abc123..."<a href="#appendix-A.2.4-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.4-3.4">
              <p id="appendix-A.2.4-3.4.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Content-Type: application/json; charset=utf-8
                  ETag: "sha256-xyz789..."<a href="#appendix-A.2.4-3.4.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.4-3.4.2">
<pre>
              {
                "canonical_url": "https://example.com/article/",
                "title": "Updated Title",
                "content": "Updated content...",
                "hash": "sha256-xyz789..."
              }
</pre><a href="#appendix-A.2.4-3.4.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.4-3.5">
              <p id="appendix-A.2.4-3.5.1">Client actions:<a href="#appendix-A.2.4-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.4-3.5.2.1">
                  <p id="appendix-A.2.4-3.5.2.1.1">Replaces cached content<a href="#appendix-A.2.4-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.4-3.5.2.2">
                  <p id="appendix-A.2.4-3.5.2.2.1">Updates cached ETag to "sha256-xyz789..."
```<a href="#appendix-A.2.4-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="appendix-A.2.4-4"><strong>Result:</strong> Full new representation received.<a href="#appendix-A.2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b5-parity-mismatch-handling">
<section id="appendix-A.2.5">
          <h4 id="name-b5-parity-mismatch-handling">
<a href="#appendix-A.2.5" class="section-number selfRef">A.2.5. </a><a href="#name-b5-parity-mismatch-handling" class="section-name selfRef">B.5. Parity Mismatch Handling</a>
          </h4>
<p id="appendix-A.2.5-1"><strong>Scenario:</strong> Sitemap etag doesn't match actual M-URL ETag (transient inconsistency).<a href="#appendix-A.2.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.5-2">```
1. Client -&gt; Server: GET /llm-pages.json HTTP/1.1<a href="#appendix-A.2.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.5-3">
<li id="appendix-A.2.5-3.1">
              <p id="appendix-A.2.5-3.1.1">Server -&gt; Client: [Sitemap shows etag: "sha256-old999..."]<a href="#appendix-A.2.5-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.5-3.2">
              <p id="appendix-A.2.5-3.2.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1
                  If-None-Match: "sha256-old999..."<a href="#appendix-A.2.5-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.5-3.3">
              <p id="appendix-A.2.5-3.3.1">Server -&gt; Client: HTTP/1.1 200 OK
                  ETag: "sha256-new000..."  &lt;- Different from sitemap!<a href="#appendix-A.2.5-3.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.5-3.3.2">
<pre>
              [Full M-URL JSON...]
</pre><a href="#appendix-A.2.5-3.3.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.5-3.4">
              <p id="appendix-A.2.5-3.4.1">Client actions:<a href="#appendix-A.2.5-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.5-3.4.2.1">
                  <p id="appendix-A.2.5-3.4.2.1.1">Accepts M-URL response (valid per HTTP)<a href="#appendix-A.2.5-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.5-3.4.2.2">
                  <p id="appendix-A.2.5-3.4.2.2.1">Uses ETag from M-URL response ("sha256-new000...") for future revalidation<a href="#appendix-A.2.5-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.5-3.4.2.3">
                  <p id="appendix-A.2.5-3.4.2.3.1">Notes: sitemap inconsistency tolerated; no error
```<a href="#appendix-A.2.5-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="appendix-A.2.5-4"><strong>Result:</strong> Client falls back to standard HTTP caching; no protocol failure.<a href="#appendix-A.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b6-using-head-for-efficient-freshness-check">
<section id="appendix-A.2.6">
          <h4 id="name-b6-using-head-for-efficient">
<a href="#appendix-A.2.6" class="section-number selfRef">A.2.6. </a><a href="#name-b6-using-head-for-efficient" class="section-name selfRef">B.6. Using HEAD for Efficient Freshness Check</a>
          </h4>
<p id="appendix-A.2.6-1"><strong>Scenario:</strong> Client wants to check freshness before fetching.<a href="#appendix-A.2.6-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.6-2">```
1. Client -&gt; Server: HEAD /article/llm.json HTTP/1.1
                     If-None-Match: "sha256-abc123..."<a href="#appendix-A.2.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.6-3">
<li id="appendix-A.2.6-3.1">
              <p id="appendix-A.2.6-3.1.1">Server -&gt; Client: HTTP/1.1 304 Not Modified
                  ETag: "sha256-abc123..."<a href="#appendix-A.2.6-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.6-3.2">
              <p id="appendix-A.2.6-3.2.1">Client actions:<a href="#appendix-A.2.6-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.6-3.2.2.1">
                  <p id="appendix-A.2.6-3.2.2.1.1">Content unchanged; uses cached copy<a href="#appendix-A.2.6-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="appendix-A.2.6-3.2.2.2">
                  <p id="appendix-A.2.6-3.2.2.2.1">Avoided transferring full body<a href="#appendix-A.2.6-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="appendix-A.2.6-4">OR (if content changed):<a href="#appendix-A.2.6-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.6-5">
<li id="appendix-A.2.6-5.1">
              <p id="appendix-A.2.6-5.1.1">Server -&gt; Client: HTTP/1.1 200 OK
                  ETag: "sha256-xyz789..."
                  Content-Length: 4567<a href="#appendix-A.2.6-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.6-5.2">
              <p id="appendix-A.2.6-5.2.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1
                  If-None-Match: "sha256-abc123..."<a href="#appendix-A.2.6-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.6-5.3">
              <p id="appendix-A.2.6-5.3.1">Server -&gt; Client: HTTP/1.1 200 OK
                  ETag: "sha256-xyz789..."<a href="#appendix-A.2.6-5.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.6-5.3.2">
<pre>
              [Full M-URL JSON...] ```
</pre><a href="#appendix-A.2.6-5.3.2" class="pilcrow">¶</a>
</div>
</li>
          </ol>
<p id="appendix-A.2.6-6"><strong>Note:</strong> HEAD support is optional; conditional GET is the primary mechanism.<a href="#appendix-A.2.6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="b7-discovery-via-c-url">
<section id="appendix-A.2.7">
          <h4 id="name-b7-discovery-via-c-url">
<a href="#appendix-A.2.7" class="section-number selfRef">A.2.7. </a><a href="#name-b7-discovery-via-c-url" class="section-name selfRef">B.7. Discovery via C-URL</a>
          </h4>
<p id="appendix-A.2.7-1"><strong>Scenario:</strong> Client discovers M-URL directly from HTML page.<a href="#appendix-A.2.7-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.7-2">```
1. Client -&gt; Server: GET /article/ HTTP/1.1<a href="#appendix-A.2.7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2.7-3">
<li id="appendix-A.2.7-3.1">
              <p id="appendix-A.2.7-3.1.1">Server -&gt; Client: HTTP/1.1 200 OK
                  Link: &lt;/article/llm.json&gt;; rel="alternate"; type="application/json"
                  Content-Type: text/html<a href="#appendix-A.2.7-3.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.7-3.1.2">
<pre>
              &lt;!DOCTYPE html&gt;
              &lt;html&gt;
              &lt;head&gt;
                &lt;link rel="alternate" type="application/json"
                      href="https://example.com/article/llm.json"&gt;
              &lt;/head&gt;
              ...
</pre><a href="#appendix-A.2.7-3.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.7-3.2">
              <p id="appendix-A.2.7-3.2.1">Client -&gt; Server: GET /article/llm.json HTTP/1.1<a href="#appendix-A.2.7-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-A.2.7-3.3">
              <p id="appendix-A.2.7-3.3.1">Server -&gt; Client: HTTP/1.1 200 OK
                  ETag: "sha256-abc123..."
                  Link: <a href="https://example.com/article/">https://example.com/article/</a>; rel="canonical"<a href="#appendix-A.2.7-3.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2.7-3.3.2">
<pre>
              [M-URL JSON...]
</pre><a href="#appendix-A.2.7-3.3.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="appendix-A.2.7-3.4">
              <p id="appendix-A.2.7-3.4.1">Client verifies:<a href="#appendix-A.2.7-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.7-3.4.2.1">
                  <p id="appendix-A.2.7-3.4.2.1.1">Canonical link points back to /article/ -&gt; Consistent OK
```<a href="#appendix-A.2.7-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ol>
<p id="appendix-A.2.7-4"><strong>Result:</strong> M-URL discovered and validated without sitemap.<a href="#appendix-A.2.7-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-c-implementation-notes-informative">
<section id="appendix-A.3">
        <h3 id="name-appendix-c-implementation-n">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-appendix-c-implementation-n" class="section-name selfRef">Appendix C. Implementation Notes (Informative)</a>
        </h3>
<p id="appendix-A.3-1">This appendix provides guidance for implementers.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div id="c1-reference-implementations">
<section id="appendix-A.3.1">
          <h4 id="name-c1-reference-implementation">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-c1-reference-implementation" class="section-name selfRef">C.1. Reference Implementations</a>
          </h4>
<p id="appendix-A.3.1-1"><strong>Note:</strong> The following implementations are provided as informative examples. Repository URLs, package names, and deployment details may change over time and are not normative.<a href="#appendix-A.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.1-2">The following implementations demonstrate TCT in production environments:<a href="#appendix-A.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.1-3"><strong>WordPress Plugin (PHP):</strong>
- Repository: https://github.com/antunjurkovic-collab/tct-wp-plugin
- Version: 1.0.0
- Deployment: 3 production sites (970 URLs total)
- Features:
  - Automatic M-URL generation for posts/pages
  - M-Sitemap generation and caching
  - Strong ETag computation using canonical JSON
  - Normalization algorithm implementation
- Dependencies: WordPress 6.0+, PHP 7.4+
- JSON serialization: <code>json_encode()</code> with <code>JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE</code><a href="#appendix-A.3.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3.1-4"><strong>Python Validator:</strong>
- PyPI package: <code>collab-tunnel</code> (https://pypi.org/project/collab-tunnel/1.0.2/)
- Version: 1.0.2
- Purpose: Protocol compliance testing
- Features:
  - Validates M-URL and M-Sitemap structure
  - Tests ETag parity
  - Verifies canonical link bidirectionality
  - Runs normalization test vectors
- Usage:
  <code>python
  from collab_tunnel import validate_origin
  results = validate_origin("https://example.com")
            </code><a href="#appendix-A.3.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3.1-5"><strong>Cloudflare Worker (Edge Proxy):</strong>
- Repository: https://github.com/antunjurkovic-collab/tct-worker
- Purpose: Demonstrates CDN integration
- Features:
  - Proxies M-URLs with proper ETag handling
  - Implements 304 Not Modified caching
  - Handles conditional requests correctly
- Deployment: Cloudflare Workers platform<a href="#appendix-A.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c2-deterministic-json-libraries">
<section id="appendix-A.3.2">
          <h4 id="name-c2-deterministic-json-libra">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-c2-deterministic-json-libra" class="section-name selfRef">C.2. Deterministic JSON Libraries</a>
          </h4>
<p id="appendix-A.3.2-1">For RFC 8785 (JSON Canonicalization Scheme) compliance:<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-2"><strong>Python:</strong>
            <code>python
import canonicaljson
canonical_bytes = canonicaljson.encode_canonical_json(obj)
</code>
- Library: <code>pip install canonicaljson</code>
- Docs: https://github.com/matrix-org/python-canonicaljson<a href="#appendix-A.3.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-3"><strong>JavaScript:</strong>
            <code>javascript
const canonicalize = require('canonicalize');
const canonical_string = canonicalize(obj);
</code>
- Library: <code>npm install canonicalize</code>
- Docs: https://github.com/cyberphone/json-canonicalization<a href="#appendix-A.3.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-4"><strong>Go:</strong>
            <code>go
import "github.com/cyberphone/json-canonicalization/go/json"
canonical, _ := json.CanonicalizeJSON(input)
</code><a href="#appendix-A.3.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-5"><strong>Alternative (Stable Ordering):</strong>
If not using RFC 8785, ensure:
- Object keys sorted lexicographically (at ALL nesting levels)
- No insignificant whitespace
- Consistent number formatting
- UTF-8 encoding without BOM<a href="#appendix-A.3.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-6"><strong>Important:</strong> Simple key-sorting helpers (e.g., <code>Object.keys(obj).sort()</code> in JavaScript) are <strong>insufficient</strong> for nested objects. For production implementations claiming TCT conformance, use RFC 8785 libraries or implement the full specification. The code examples in C.3 are <strong>illustrative only</strong> and may not handle all edge cases correctly.<a href="#appendix-A.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c3-sha-256-computation">
<section id="appendix-A.3.3">
          <h4 id="name-c3-sha-256-computation">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-c3-sha-256-computation" class="section-name selfRef">C.3. SHA-256 Computation</a>
          </h4>
<p id="appendix-A.3.3-1">The examples in this section are illustrative only. By themselves they do not guarantee the deterministic JSON requirements of Section 6.1 unless combined with a complete canonicalization algorithm such as RFC8785.<a href="#appendix-A.3.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-2"><strong>Note:</strong> The examples below are simplified for illustration. For production use, ensure proper RFC 8785 canonicalization (see C.2) before hashing.<a href="#appendix-A.3.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-3"><strong>Python:</strong>
```python
import hashlib
import json<a href="#appendix-A.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="canonical-json">
<section id="appendix-B">
      <h2 id="name-canonical-json">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-canonical-json" class="section-name selfRef">Canonical JSON</a>
      </h2>
<p id="appendix-B-1">canonical_json = json.dumps(obj, ensure_ascii=False, sort_keys=True, separators=(',', ':'))
canonical_bytes = canonical_json.encode('utf-8')<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash">
<section id="appendix-C">
      <h2 id="name-hash">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-hash" class="section-name selfRef">Hash</a>
      </h2>
<p id="appendix-C-1">sha256_hash = hashlib.sha256(canonical_bytes).hexdigest()
etag_value = f'"sha256-{sha256_hash}"'
```<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2"><strong>JavaScript:</strong>
```javascript
const crypto = require('crypto');<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">// Canonical JSON
// NOTE: This is illustrative only; for full conformance, use RFC 8785 or a complete canonicalization implementation.
const canonical_json = JSON.stringify(obj, Object.keys(obj).sort());
const canonical_bytes = Buffer.from(canonical_json, 'utf-8');<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">// Hash
const sha256_hash = crypto.createHash('sha256').update(canonical_bytes).digest('hex');
const etag_value = <code>"sha256-${sha256_hash}"</code>;
```<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5"><strong>PHP:</strong>
```php
// Canonical JSON
$canonical_json = json_encode($obj, JSON_UNESCAPED_SLASHES | JSON_UNESCAPED_UNICODE);<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<p id="appendix-C-6">// Hash
$sha256_hash = hash('sha256', $canonical_json);
$etag_value = '"sha256-' . $sha256_hash . '"';
```<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<div id="c4-unicode-normalization">
<section id="appendix-C.1">
        <h3 id="name-c4-unicode-normalization">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-c4-unicode-normalization" class="section-name selfRef">C.4. Unicode Normalization</a>
        </h3>
<p id="appendix-C.1-1"><strong>Python:</strong>
```python
import unicodedata<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="nfkc-normalization">
<section id="appendix-D">
      <h2 id="name-nfkc-normalization">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-nfkc-normalization" class="section-name selfRef">NFKC normalization</a>
      </h2>
<p id="appendix-D-1">normalized = unicodedata.normalize('NFKC', text)<a href="#appendix-D-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="case-folding">
<section id="appendix-E">
      <h2 id="name-case-folding">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-case-folding" class="section-name selfRef">Case folding</a>
      </h2>
<p id="appendix-E-1">casefolded = normalized.casefold()
```<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2"><strong>JavaScript:</strong>
```javascript
// NFKC normalization
const normalized = text.normalize('NFKC');<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">// Case folding (approximation: toLowerCase with locale-independent behavior)
const casefolded = normalized.toLocaleLowerCase('en-US');
```<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<p id="appendix-E-4"><strong>PHP:</strong>
```php
// NFKC normalization (requires intl extension)
$normalized = Normalizer::normalize($text, Normalizer::NFKC);<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<p id="appendix-E-5">// Case folding (mb_strtolower with UTF-8)
$casefolded = mb_strtolower($normalized, 'UTF-8');
```<a href="#appendix-E-5" class="pilcrow">¶</a></p>
<div id="c5-http-response-headers">
<section id="appendix-E.1">
        <h3 id="name-c5-http-response-headers">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-c5-http-response-headers" class="section-name selfRef">C.5. HTTP Response Headers</a>
        </h3>
<p id="appendix-E.1-1"><strong>Typical headers for M-URLs:</strong><a href="#appendix-E.1-1" class="pilcrow">¶</a></p>
<p id="appendix-E.1-2">A conformant M-URL response will include at least: <code>Content-Type: application/json</code>, <code>ETag</code> (strong, quoted), and <code>Link: rel="canonical"</code> (see Sections 5-6). Example:<a href="#appendix-E.1-2" class="pilcrow">¶</a></p>
<p id="appendix-E.1-3"><code>
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
ETag: "sha256-abc123..."
Link: &lt;https://example.com/article/&gt;; rel="canonical"
Cache-Control: public, max-age=3600, must-revalidate
Vary: Accept-Encoding
</code><a href="#appendix-E.1-3" class="pilcrow">¶</a></p>
<p id="appendix-E.1-4"><strong>Typical headers for M-Sitemap:</strong>
          <code>
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8
Cache-Control: max-age=0, must-revalidate
# Example; a short max-age consistent with Section 7.2 MAY also be used
Vary: Accept-Encoding
</code><a href="#appendix-E.1-4" class="pilcrow">¶</a></p>
<p id="appendix-E.1-5"><strong>Conditional request handling:</strong>
```
# Request with If-None-Match
GET /article/llm.json HTTP/1.1
If-None-Match: "sha256-abc123..."<a href="#appendix-E.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="response-if-unchanged">
<section id="appendix-F">
      <h2 id="name-response-if-unchanged">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-response-if-unchanged" class="section-name selfRef">Response if unchanged</a>
      </h2>
<p id="appendix-F-1">HTTP/1.1 304 Not Modified
ETag: "sha256-abc123..."
Cache-Control: public, max-age=3600, must-revalidate<a href="#appendix-F-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-if-changed">
<section id="appendix-G">
      <h2 id="name-response-if-changed">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-response-if-changed" class="section-name selfRef">Response if changed</a>
      </h2>
<p id="appendix-G-1">HTTP/1.1 200 OK
ETag: "sha256-xyz789..."
Content-Type: application/json; charset=utf-8
[full body...]
```<a href="#appendix-G-1" class="pilcrow">¶</a></p>
<div id="c6-production-deployment-data">
<section id="appendix-G.1">
        <h3 id="name-c6-production-deployment-da">
<a href="#appendix-G.1" class="section-number selfRef">G.1. </a><a href="#name-c6-production-deployment-da" class="section-name selfRef">C.6. Production Deployment Data</a>
        </h3>
<p id="appendix-G.1-1"><strong>Note:</strong> The following deployment data represents a snapshot as of November 2025. Specific sites, URLs, and metrics are provided as informative examples and may change.<a href="#appendix-G.1-1" class="pilcrow">¶</a></p>
<p id="appendix-G.1-2">As of November 2025, TCT is deployed on:<a href="#appendix-G.1-2" class="pilcrow">¶</a></p>
<p id="appendix-G.1-3"><strong>bestdemotivationalposters.com:</strong>
- 500 URLs
- 100K+ pageviews/month
- WordPress 6.4 + TCT plugin v1.0.0
- Average HTML size: 103 KB (gzipped)
- Average M-URL size: 17.7 KB (gzipped)
- Bandwidth reduction: 83%<a href="#appendix-G.1-3" class="pilcrow">¶</a></p>
<p id="appendix-G.1-4"><strong>wellbeing-support.com:</strong>
- 400 URLs
- Health/wellness content
- Average zero-fetch rate: 85%<a href="#appendix-G.1-4" class="pilcrow">¶</a></p>
<p id="appendix-G.1-5"><strong>omacedonii.com:</strong>
- 70 URLs
- Multilingual (Polish)
- Demonstrates Unicode normalization in production<a href="#appendix-G.1-5" class="pilcrow">¶</a></p>
<p id="appendix-G.1-6"><strong>Aggregate Results:</strong>
- Total URLs: 970
- Bandwidth reduction: 83% median
- Zero-fetch rate: 70-90% (depends on update frequency)
- Combined bandwidth elimination: ~98% in steady-state<a href="#appendix-G.1-6" class="pilcrow">¶</a></p>
<div id="c7-common-implementation-pitfalls">
<section id="appendix-G.1.1">
          <h4 id="name-c7-common-implementation-pi">
<a href="#appendix-G.1.1" class="section-number selfRef">G.1.1. </a><a href="#name-c7-common-implementation-pi" class="section-name selfRef">C.7. Common Implementation Pitfalls</a>
          </h4>
<p id="appendix-G.1.1-1"><strong>Pitfall 1: Non-deterministic JSON</strong>
- Problem: Random key ordering, floating-point precision issues, timestamps
- Solution: Use RFC 8785 or strict ordering; exclude per-request randomness<a href="#appendix-G.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-2"><strong>Pitfall 2: Weak ETags</strong>
- Problem: Using <code>W/"sha256-..."</code> instead of <code>"sha256-..."</code>
- Solution: Always use strong ETags for M-URLs (no W/ prefix)<a href="#appendix-G.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-3"><strong>Pitfall 3: Sitemap Staleness</strong>
- Problem: Sitemap regenerated asynchronously; race conditions cause mismatches
- Solution: Accept transient inconsistency; clients fall back to conditional GET<a href="#appendix-G.1.1-3" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-4"><strong>Pitfall 4: Incorrect Canonical Links</strong>
- Problem: rel="canonical" points to wrong URL or is missing
- Solution: Validate bidirectional linkage (C-URL &lt;-&gt; M-URL)<a href="#appendix-G.1.1-4" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-5"><strong>Pitfall 5: HTML in Content Field</strong>
- Problem: Including raw HTML tags in <code>content</code> field
- Solution: Extract plain text or use deterministic markup (e.g., Markdown)<a href="#appendix-G.1.1-5" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-6"><strong>Pitfall 6: Missing Vary: Accept-Encoding</strong>
- Problem: CDN caches gzipped and uncompressed versions with same key
- Solution: Always include <code>Vary: Accept-Encoding</code> header<a href="#appendix-G.1.1-6" class="pilcrow">¶</a></p>
<p id="appendix-G.1.1-7"><strong>Pitfall 7: Locale-Dependent Case Folding</strong>
- Problem: Turkish İ -&gt; i vs. I -&gt; ı (locale-specific)
- Solution: Use Unicode default case folding (locale-independent)<a href="#appendix-G.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c8-testing-and-validation">
<section id="appendix-G.1.2">
          <h4 id="name-c8-testing-and-validation">
<a href="#appendix-G.1.2" class="section-number selfRef">G.1.2. </a><a href="#name-c8-testing-and-validation" class="section-name selfRef">C.8. Testing and Validation</a>
          </h4>
<p id="appendix-G.1.2-1"><strong>Automated Testing:</strong>
1. Protocol compliance: Use <code>collab-tunnel-validator</code> PyPI package
2. Normalization: Run Appendix A test vectors
3. ETag parity: Compare sitemap etag vs. actual M-URL ETag
4. Conditional requests: Test If-None-Match with matching/non-matching ETags<a href="#appendix-G.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-G.1.2-2"><strong>Manual Testing:</strong>
1. Check discovery: <code>curl -I https://example.com/</code> (look for Link header)
2. Fetch sitemap: <code>curl https://example.com/llm-pages.json</code>
3. Validate M-URL: <code>curl -H "Accept: application/json" https://example.com/article/llm.json</code>
4. Test 304: <code>curl -H 'If-None-Match: "sha256-..."' https://example.com/article/llm.json</code><a href="#appendix-G.1.2-2" class="pilcrow">¶</a></p>
<p id="appendix-G.1.2-3"><strong>Integration Testing:</strong>
- Deploy to staging environment
- Monitor 304 response rates (should be &gt;70% after initial crawl)
- Check CDN cache hit rates
- Verify canonical link bidirectionality<a href="#appendix-G.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c9-performance-considerations">
<section id="appendix-G.1.3">
          <h4 id="name-c9-performance-consideratio">
<a href="#appendix-G.1.3" class="section-number selfRef">G.1.3. </a><a href="#name-c9-performance-consideratio" class="section-name selfRef">C.9. Performance Considerations</a>
          </h4>
<p id="appendix-G.1.3-1"><strong>Server-Side:</strong>
- Cache normalized content and ETags (don't recompute on every request)
- Generate M-Sitemap asynchronously during content updates
- Use HTTP/2 for parallel M-URL fetches
- Implement early ETag validation (before full response generation)<a href="#appendix-G.1.3-1" class="pilcrow">¶</a></p>
<p id="appendix-G.1.3-2"><strong>Client-Side:</strong>
- Use zero-fetch optimization when possible (sitemap comparison)
- Batch M-Sitemap fetches (don't fetch per-URL)
- Implement exponential backoff for 429/503 responses
- Cache M-URLs and ETags persistently<a href="#appendix-G.1.3-2" class="pilcrow">¶</a></p>
<p id="appendix-G.1.3-3"><strong>CDN/Proxy:</strong>
- Configure strong ETag preservation
- Enable compression (gzip/brotli) with Vary: Accept-Encoding
- Cache 304 responses appropriately
- Don't strip ETag headers<a href="#appendix-G.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="c10-security-best-practices">
<section id="appendix-G.1.4">
          <h4 id="name-c10-security-best-practices">
<a href="#appendix-G.1.4" class="section-number selfRef">G.1.4. </a><a href="#name-c10-security-best-practices" class="section-name selfRef">C.10. Security Best Practices</a>
          </h4>
<p id="appendix-G.1.4-1"><strong>HTTPS:</strong>
- It is RECOMMENDED to serve M-URLs and M-Sitemap over HTTPS (see Section 10)
- Validate TLS certificates properly
- Use HSTS where appropriate<a href="#appendix-G.1.4-1" class="pilcrow">¶</a></p>
<p id="appendix-G.1.4-2"><strong>Access Control:</strong>
- If C-URL requires authentication, protect M-URL similarly
- Don't leak sensitive URLs in public sitemaps
- Implement rate limiting to prevent abuse<a href="#appendix-G.1.4-2" class="pilcrow">¶</a></p>
<p id="appendix-G.1.4-3"><strong>Content Validation:</strong>
- Treat M-URL JSON as untrusted input
- Validate/sanitize before use
- Don't execute code from content field<a href="#appendix-G.1.4-3" class="pilcrow">¶</a></p>
<p id="appendix-G.1.4-4"><strong>ETag Integrity:</strong>
- Use Content-Digest (RFC 9530) for additional integrity
- Consider HTTP Message Signatures (RFC 9421) for authentication
- Monitor for ETag collision attempts (though SHA-256 makes this infeasible)<a href="#appendix-G.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-H">
      <h2 id="name-acknowledgments">
<a href="#appendix-H" class="section-number selfRef">Appendix H. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-H-1">Thanks to reviewers and implementers who provided feedback on earlier revisions, including those who highlighted:<a href="#appendix-H-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-H-2.1">
          <p id="appendix-H-2.1.1">the need for a single strong ETag method;<a href="#appendix-H-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-H-2.2">
          <p id="appendix-H-2.2.1">the importance of deterministic JSON;<a href="#appendix-H-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-H-2.3">
          <p id="appendix-H-2.3.1">the separation of protocol from policy; and<a href="#appendix-H-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-H-2.4">
          <p id="appendix-H-2.4.1">simplification of discovery and parity semantics.<a href="#appendix-H-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-I">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Antun Jurkovikj</span></div>
<div dir="auto" class="left"><span class="country-name">North Macedonia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:antunjurkovic@gmail.com" class="email">antunjurkovic@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
